# Rails 应用程序中多租户的优缺点是什么？

> 原文：<https://medium.com/swlh/what-are-the-pros-and-cons-of-multi-tenancy-in-rails-application-547d0f9c205f>

![](img/f8bea01119661dea4e9a5c26320fcb05.png)

What Are The Pros And Cons Of Multi-tenancy In Rails Application?

这里有多种方法可以让 T2 开发一个网络应用来满足不同的需求。有时，在称为单租户的设置中，为每个客户安装一个单独的应用程序实例。而在多租户应用程序中，软件和支持基础设施的单个实例在多租户架构中为多个用户服务。在这里，每个客户或租户共享软件应用程序和一个数据库。在多租户架构中，应用程序旨在隔离配置和数据，以确保每个租户都使用定制的虚拟应用程序实例。一旦数据库中的数据被标记为属于某个用户或另一个用户，该软件足够智能，可以知道这些数据属于谁。

多租户应用程序主要分为三类用户。拥有顶级访问权限的管理员，是拥有网站的客户。然后是经理，来自[公司](https://www.datadab.com/)的资源，他们在公司层面管理项目和用户，最后是这个应用程序的最终用户。根据用户的授权，用户可以访问每个页面。用户可以定制应用程序的某些部分，比如用户界面(UI)的颜色或业务规则，但是他们不能定制应用程序的代码。

# 多租户的优势:

*   多租户通过在其客户端之间共享相同的电源资源和软件来降低成本。软件需要许可证和支持，如果您需要为每个客户购买许可证和支持，成本会增加，就像单租户的情况一样。共享基础设施将自动降低成本。
*   在多租户应用程序中，您只需监控和管理单个平台，而不像单租户应用程序那样，您必须管理每个客户端的不同集合。通过这种方式，多租户 SaaS 提供商可以提供更高效的支持，包括问题解决和故障排除。
*   多租户体系结构将使您在需要更高的强度和功率时能够轻松增加容量。当您为平台引入新硬件时，整个系统的总容量会增加，并且变得更具可扩展性，不仅仅是针对单个客户端，而是针对所有关联的客户端。为单个客户端添加功能可使其对其他客户端可用。
*   为多租户应用程序升级软件版本或系统资源非常容易，因为有一个集中的地方进行升级、安装等。

# 多租户的缺点:

*   与单租户应用相比，多租户应用在设置低级配置方面的灵活性较低。这对您来说可能不是问题，但如果您的应用程序需要为每个新租户进行大量定制，那么多租户应用程序可能不是最佳解决方案。
*   多租户应用比同等的单租户应用更复杂，单租户应用的配置基本上是静态的。在单租户应用程序中，您不需要任何代码来检测 web 请求是针对哪个租户的，或者保护您的客户端免受租户之间的数据泄漏。日志格式更简单，因为日志与每个客户端的应用程序的单独实例分离。
*   由于多租户应用程序由运行在单个服务器上的单个数据库支持，因此容易出现故障的地方较少，但是这些故障点可能会造成更大的灾难。与单租户应用程序实例中断不同，当多租户应用程序的数据库不可用时，所有租户都会失去服务。它会拖垮一个租户。其他实例继续不受影响。

# 如何创建多租户 Rails 应用程序？

Apartment 是一个顶级的 Ruby 库，以分离租户数据而闻名。简单地说，您可以使用 Apartment 创建租户，对于每个租户，库将自动分配一个新的隔离模式。使用 Apartment 也可以创建独立的数据库实例。Apartment 将为您提供工具，帮助您在 Rails 应用程序中处理多个租户。虽然仍然允许一些数据存在于一个公共租户中，但如果您需要基于公司或帐户隔离某些数据，Apartment 可以提供帮助。Apartment 将允许你从一开始就使用部分或全部白色标签来构建基于 Rails 的 SaaS 应用程序。为了充分利用 Apartment，可以考虑使用 PostgreSQL 数据库。

公寓是如何运作的？Apartment 从对应于电梯的模式中获取数据:域、子域或完整的主机名。使用这些电梯，图书馆分析每个对数据库的请求。默认情况下，公寓通过子域隔离租户，但您可以设置它来快速使用域。请记住，对于共享模式，Apartment 不起作用。您的开发团队只需要为租户分配 id，并使用这些 id 发送数据库请求来实现共享模式方法，如果您要为客户端提供子域或自定义域，则需要 Detectify。对于现代的基于 Rails 的 SaaS 应用程序，你会想要更多的灵活性。这就是 Detectify 的用武之地。Detectify 可以使用子域和域构建数据库请求。Detectify 在向数据库发送基于 URL 的请求时，也会让应用程序忽略路线。总的来说，Detectify 被证明是比 Houser 更先进的多租户 gem。

# 结论:

> 多租户通常是一个被误解和误用的术语。多租户是一种架构方法，允许多个组织或用户(也称为租户)共享应用程序的单个实例，仅适用于 SaaS。这里的核心原则是，共享的是应用程序的单个实例。因此，多实例架构不同于多租户架构。

任何设计糟糕的东西都不会完美地工作，但是在大多数情况下，设计糟糕的多租户不会给你带来任何好处。这是因为设计不佳的多租户会影响自动化等，从而阻碍 it 的核心功能，即降低运营成本。使用 Rails 开发多租户[软件即服务应用](https://www.cognitiveclouds.com/custom-software-development-services/saas-application-development-company)不仅仅是设计数据库层。如果您在一开始就选择了完美的数据库架构，那么从长远来看，开发、扩展和支持您的 web 应用程序将会容易得多。

*最初发表于 CognitiveClouds 的产品洞察博客:Top* [***Ruby on Rails 开发公司***](https://www.cognitiveclouds.com/custom-software-development-services/ruby-on-rails-development-company)

![](img/731acf26f5d44fdc58d99a6388fe935d.png)

## 这个故事发表在 [The Startup](https://medium.com/swlh) 上，这是 Medium 最大的企业家出版物，拥有 293，189+人。

## 在此订阅接收[我们的头条新闻](http://growthsupply.com/the-startup-newsletter/)。

![](img/731acf26f5d44fdc58d99a6388fe935d.png)