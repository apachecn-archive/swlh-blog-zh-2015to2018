<html>
<head>
<title>What are the best practices when testing Rails apps?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">测试Rails应用的最佳实践是什么？</h1>
<blockquote>原文：<a href="https://medium.com/swlh/what-are-the-best-practices-when-testing-rails-apps-1fcf0d7e7bf9#2017-07-28">https://medium.com/swlh/what-are-the-best-practices-when-testing-rails-apps-1fcf0d7e7bf9#2017-07-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8e2c93d18fe184830cecbc57873dfb41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mrMmlKOgkClY1kz7Glrk5A.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">What are the best practices when testing Rails apps?</figcaption></figure><p id="9f23" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi js translated">今天，你的开发人员可以使用测试驱动的开发风格(TDD)和行为驱动的开发风格(BDD)编写极其复杂的测试，同时利用强大的测试框架，使用RSpec和Cucumber这样的宝石。默认情况下，Rails具有强大的自动化测试功能，这使得编写测试变得很容易。首先，如果你是新手，我建议采用测试驱动的开发方式，否则，试试行为驱动的开发方法。其次，请记住，当您的应用程序仍处于初始阶段时，为其构建安全措施要容易得多，并且这最终会通过在以后实施良好的开发实践来提高质量。另一方面，如果您已经构建了自己的Rails应用程序，并且测试是您的应用程序和用户之间的唯一障碍，那么通过正确的测试，您可以将疑虑放在一边，开始使用它。</p><p id="82c8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">即使对于跳过设计方法一半阶段的不太认真的程序员来说，不经过测试就写代码也是一种鲁莽的行为。网上有足够的资源来帮助你，让你没有任何理由不接触测试。尽管向Rails应用程序中添加自动化测试是多么简单，但令人不快的是，我们会惊奇地发现有多少项目没有测试，或者最多只有很少的测试是由以前的开发团队编写的。关于应该如何全面测试的争论将会继续。然而，至少需要一个基本的自动化测试是一致的，并且应该存在于所有的应用程序中。</p><p id="7738" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">确保为控制器中的每个动作编写至少一个高级集成测试是一个很好的规则。将来，这将为开发人员提供一种验证应用程序基本功能的清晰方法，以确保当开发人员决定修改代码或升级Rails版本时，应用程序能够正常工作。此外，这种方法为未来的开发人员提供了应用程序所提供的全部功能的清晰画面。</p><h1 id="cf09" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">不同形式的测试</h1><p id="34b2" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">在典型的Rails应用程序中，您会发现三种主要的测试类型，模型(单元)测试、控制器测试和视图测试。在需要的地方也使用特征测试。这些测试对您的应用程序进行端到端的运行测试。这些测试中的每一个都在测试世界中占有一席之地，并且可能对你同样重要。</p><h1 id="bddc" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">模型(单元)测试</h1><p id="a8a2" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">模型或单元规格是您将在Rails中处理的最简单和最快的测试类型。这里，您正在测试模型对象上的普通CRUD(创建/读取/更新/删除)操作。此外，它们是相当独立的，可以用来测试关联和验证。</p><h1 id="b5be" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">控制器测试</h1><p id="b159" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">我敢肯定，你已经遇到了流行的铁路哲学，“胖模型瘦控制器。”接受这一点，并把它作为你的开发目标，让控制器摆脱可避免的逻辑并保持流线型。在为控制器编写测试用例时，重点检查三个方面:控制器响应、返回数据和重定向与呈现。具体来说，检查是否呈现了正确的模板。您的控制器测试，本质上也包括测试Rails RESTful架构以及视图。</p><p id="f628" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">控制器是应用程序不可或缺的一部分，因为Rails主要是一个web开发框架。控制器测试将成为你测试所有条件逻辑的支柱。测试基于请求类型、用户类型、成功或失败、模型等等。由于使用了请求/响应周期，控制器规格比模型规格稍慢一些。即便如此，它们仍然比功能规格快得多。当你需要测试一个控制器的多条路径时，控制器规格应该优先于特性规格，因为它们通常更容易编写，运行更快。这使得它成为进行大量测试的理想场所。</p><h1 id="5cb3" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">查看测试</h1><p id="354c" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">视图规范经常被程序员忽略，他们选择在特性测试中测试视觉表现的所有方面。特性测试不应该被用来测试服务器渲染模板的每一个细节。它们是为了给你一个高水平的行为测试。每当您需要基于一些if语句或逻辑测试不同的标记时，请使用view spec。视图规范非常适合在模板中进行测试，即信息的条件显示。相反，使用特性测试是你最终得到一个长时间运行的测试套件的原因。</p><h1 id="cd9c" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">功能测试</h1><p id="6378" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">从用户的角度来看，这是一次性测试整个应用程序或大部分行为的极好方法。特性规格是高层次的测试，它会遍历整个应用程序，确保每个组件都能协同工作。RSpec和Capybara允许您编写能够以这种方式与网页交互的测试。但是，功能测试比所有其他类型的测试运行得都慢。因此，明智的做法是不要使用特性测试来测试应用程序中的每个分支。使用控制器或其他规格来测试边缘情况。</p><h1 id="27b4" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">测试框架</h1><h1 id="3387" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">RSpec</h1><p id="ca9d" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">这个Rails gem是测试Rails应用程序的良好起点。语法关注测试的可读性和可组合性。RSpec有各种类型的测试，您可以运行这些测试来确保您的应用程序已经为它的首次亮相做好准备。首先，您可以运行一个特性规格测试。这些测试逐行检查应用程序，以确保所有组件都能协同工作。如果您的应用程序通过了这个测试，您就可以确信有一个积极的用户体验。接下来，您可以继续进行模型规格测试。这些测试将应用程序分成小块。每个程序块都经过单独测试，以确保其正常工作。您还可以使用该工具来运行控制器和查看规格测试。有了所有这些特性，你的应用程序在上线前将通过ringer。</p><h1 id="8c71" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">黄瓜</h1><p id="9c49" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">Cucumber提倡行为驱动开发(BDD)风格，支持在浏览器和内存中执行。不管它的诋毁者想让你相信什么，黄瓜不是一个毫无意义的工具。工具只有在你创造它的时候才有用。如果你有一个投资的业务团队，他们希望看到你的自动化测试套件的价值，或者你的领域对每个人来说都足够复杂，包括程序员，那么Cucumber是非常有价值的，并且他们会从用外行的术语解释事情中受益。Cucumber不仅仅是一个测试框架，更是一个协作框架。如果你不与业务团队和程序员合作，那么黄瓜将被证明是无用的。话说回来，理想情况下你们应该合作。一旦你开始使用Cucumber，你会发现它为你提供了最好最简单的行为驱动开发。它运行自动化测试，因此您可以确保您的应用程序符合标准。当人们与你的应用程序交互时，你首先要弄清楚你所期望的行为。然后你可以使用这些例子来运行验收测试。Cucumber将确定你的哪些目标正在实现，哪些例子没有实现。然后，它编译一个包括规格和测试的文档。这使得你的团队很容易解决问题并继续前进。</p><h1 id="187f" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">迷你测试</h1><p id="f66f" class="pw-post-body-paragraph iu iv hi iw b ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn ld jp jq jr hb bi translated">Minitest是Rails最新版本中包含的默认测试框架。官方的Rails测试指南是另一本指导您完成Minitest的好书。Minitest也是一个很好的起点。从检查所有的模型开始，对所有的东西进行测试，所有的作用域，所有的公共实例，所有的验证和类方法。现在不要放弃你的动力去追赶你积累的大量测试债务。当你继续前进时，确保赶上进度，每周在你的冲刺中加入一些测试债务的故事。每当你接触新代码时，确保你有测试。在你的模型测试好之前，不要碰集成测试。</p><h1 id="e0b4" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论:</h1><blockquote class="le lf lg"><p id="b2bc" class="iu iv lh iw b ix iy iz ja jb jc jd je li jg jh ji lj jk jl jm lk jo jp jq jr hb bi translated">在选择Rails应用程序的许多方面时，个人偏好将发挥巨大的作用。测试也不例外。测试应该是web开发过程中不可或缺的一部分。如果你运行适当的测试，你将会在每次发布应用程序时给人留下最好的印象。虽然我们可能会花几天时间来讨论使用哪种测试框架，但它们都有各自的优点。最重要的是你在测试。还有一句忠告；要务实，不要教条。</p></blockquote></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><p id="d89f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="lh">最初发表于CognitiveClouds的产品洞察博客:Top </em> <a class="ae ls" href="https://www.cognitiveclouds.com/custom-software-development-services/ruby-on-rails-development-company" rel="noopener ugc nofollow" target="_blank"> <strong class="iw lt"> <em class="lh"> Ruby on Rails开发公司</em> </strong> </a></p><figure class="lv lw lx ly fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="lz kc hi bd kd ma mb mc kh md me mf kl jf mg mh kp jj mi mj kt jn mk ml kx mm bi translated">这篇文章发表在<a class="ae ls" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有299，352+读者。</h2><h2 id="7945" class="lz kc hi bd kd ma mb mc kh md me mf kl jf mg mh kp jj mi mj kt jn mk ml kx mm bi translated">在这里订阅接收<a class="ae ls" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="lv lw lx ly fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>