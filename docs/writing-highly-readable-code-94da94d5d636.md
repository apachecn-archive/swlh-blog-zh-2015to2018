# 编写可读性高的代码

> 原文：<https://medium.com/swlh/writing-highly-readable-code-94da94d5d636>

我们总是被告知注释我们的代码很重要。没有注释，其他开发人员将无法理解我们做了什么，我们未来的自己在做维护时将会恐惧退缩。

然而，可读的代码不仅仅是注释文本。更重要的是它的风格、结构和命名。如果你养成了写易读的代码的习惯，你会发现自己写的注释更少了。

让我们取下面的代码片段，并优化它的可读性。

这段简洁而混乱的代码计算数组中每个用户记录的年龄，以年为单位。然后将他们的年龄添加到数组中的记录中以备后用。

那么，我们能做些什么来使这些代码易于理解呢？

## 风格

第一步是纠正[代码样式](https://en.wikipedia.org/wiki/Programming_style)。样式可能因项目而异，但应始终包括关于缩进和间距的规则。

如果您正在开始一个新项目，或者能够将您的代码重构为预定义的样式，那么建议您使用一个公认的标准。对于 PHP，最广为人知的标准是由 [PSR-1](http://www.php-fig.org/psr/psr-1/) 和 [PSR-2](http://www.php-fig.org/psr/psr-2/) 定义的。

这是代码缩进并适应最大 80 个字符的行长度后的样子。

如您所见，代码可读性更好了。它还有一个额外的好处，就是更容易编辑。

## 结构

代码结构包括从存储源代码的目录树到使用的方法和库的所有内容。在可读性方面，重要的因素是[抽象](https://en.wikipedia.org/wiki/Abstraction_(computer_science))，选择[控制结构](http://php.net/manual/en/language.control-structures.php)，数据结构和[使用临时变量](http://programmers.stackexchange.com/questions/167777/why-should-one-use-a-single-use-temporary-variable)。

在这种情况下，重构结构意味着将 for 循环改为 foreach 循环，并将年龄计算分成几个步骤。foreach 循环中的值已被设置为按引用赋值，因此当值发生更改时，数组将会更新。

我们现在可以很容易地看到年龄计算中涉及的各个步骤，以及结果存储在数组中的位置。通过使用 foreach 循环，在访问用户记录时不再需要使用额外的计数器变量。

另一个可能的变化是创建一个函数或方法来执行年龄计算。尤其是在需要在[多个地方](https://en.wikipedia.org/wiki/Don%27t_repeat_yourself)计算年龄的较大项目中。

## 命名

你一定听说过“[自记录代码](https://en.wikipedia.org/wiki/Self-documenting)”这个术语。到目前为止，最重要的因素是为变量和数据结构选择的名字。

不要害怕使用更长的名字来提高可读性。好的文本编辑器和 ide 都有补全功能，所以较长的名字不会减慢你的速度。现代编程语言和数据库支持 50 个或更多字符的名称。再加上名称的上下文(表、名称空间、类等)，总有足够的空间来使用不缩写且有意义的名称。

在我们的例子中，用户记录使用的变量名和关键字可以通过使用反映其内容的名称来改进。记住，对于所有其他的命名，包括函数、类、属性和方法，也要应用同样的思想。

代码的目的现在更容易理解了，因为我们可以一目了然地看到每个变量中包含的内容。

## 评论

注释应该用高层次的术语说明代码的预期结果。永远不要问代码在底层做什么。他们还应该记录任何乍一看可能不明显的副作用。

在这种情况下，只需要一个注释来指定 foreach 循环正在做什么。users 数组的注释已被删除，因为现在很容易看出该数组的用途。

回过头来，将这段代码与初始代码进行比较，看看它有多容易理解。

如果您发现自己编写的代码更像早期的迭代之一，请留出时间来纠正它。随着代码库的增长，这种投资将获得数倍的回报。也考虑花时间重构现有代码。

只要稍加练习和深思熟虑，你很快就会写出可读性很高的代码。

编辑:瑞安·温彻斯特将代码[向前推进了一步](http://ryanwinchester.ca/post/refactoring-code-for-readability)，并且完全删除了注释的需要。另请参见大卫·罗莎对以下造型的不同看法。

编辑:Freek Van der Herten 采用了 Ryan Winchester 的代码，并对其进行了进一步的重构。

![](img/71d955550911c61d0aef4c66a71f8e15.png)

*发表于* **创业、旅游癖和生活黑客**

[![](img/f20f8a326d92cd024c2946c0427a85fd.png)](http://supply.us9.list-manage.com/subscribe?u=310af6eb2240d299c7032ef6c&id=d28d8861ad)[![](img/1b4fd39dd738a88ac13336ad93f1049c.png)](https://blog.growth.supply/)[![](img/93f21657a8ed7c0f741216a91b53c713.png)](https://twitter.com/swlh_)

-