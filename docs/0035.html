<html>
<head>
<title>Reactive Android Form. The recipe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应式安卓形态。食谱</h1>
<blockquote>原文：<a href="https://medium.com/swlh/reactive-android-form-the-recipe-a90822465850#2015-08-02">https://medium.com/swlh/reactive-android-form-the-recipe-a90822465850#2015-08-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="537c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个人都讨厌表单，但是有一类人更讨厌表单……<strong class="ih jd">开发人员</strong>。我们都厌倦了这些冗长的表格和处理所有可能的情况，所有的错误，然后让用户一切顺利和容易。我没有完美的解决方案，但我有一个方法可以让它变得更简单，让我说得更好。姑且称之为<strong class="ih jd"> RxForms </strong></p><h2 id="34b5" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">案件</h2><ul class=""><li id="4fec" class="jz ka hi ih b ii kb im kc iq kd iu ke iy kf jc kg kh ki kj bi translated">空输入</li><li id="39fb" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">无效输入</li><li id="4bd4" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">缺失内容</li><li id="7acb" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">接受条款和条件</li><li id="cf0c" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">启用/禁用提交按钮</li></ul><h2 id="436d" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">配料</h2><ul class=""><li id="3f34" class="jz ka hi ih b ii kb im kc iq kd iu ke iy kf jc kg kh ki kj bi translated">Android Studio(最新版本)</li><li id="e650" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><a class="ae kp" href="https://github.com/ReactiveX/RxAndroid" rel="noopener ugc nofollow" target="_blank"> RxAndroid </a></li><li id="4080" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated">Android设计支持库(可选)</li><li id="cf44" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc kg kh ki kj bi translated"><a class="ae kp" href="https://github.com/evant/gradle-retrolambda" rel="noopener ugc nofollow" target="_blank">倒车雷达</a>(可选)</li></ul><h2 id="e048" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">该方法</h2><p id="b392" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kq is it iu kr iw ix iy ks ja jb jc hb bi translated"><strong class="ih jd"> 1。将依赖项添加到您的项目中</strong></p><pre class="kt ku kv kw fd kx ky kz la aw lb bi"><span id="49c7" class="je jf hi ky b fi lc ld l le lf">dependencies {<br/>    compile <strong class="ky jd">'com.android.support:appcompat-v7:22.0.0'<br/>    </strong>compile <strong class="ky jd">'com.android.support:design:22.2.0'<br/>    </strong>compile <strong class="ky jd">'io.reactivex:rxandroid:0.25.0'<br/></strong>}</span><span id="73a8" class="je jf hi ky b fi lg ld l le lf">plugins {<br/>  id '<strong class="ky jd">me.tatarka.retrolambda' </strong>version<strong class="ky jd"> '3.2.0'</strong><br/>}<br/></span></pre><p id="42ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jd"> 2。创建表单视图</strong></p><p id="9853" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这部分是你放置你的特殊触感的地方，按照你喜欢的方式设计它，在我的例子中，我创建了一个ScrollView，它包含一些用支持视图<a class="ae kp" href="https://cdn-images-1.medium.com/max/1000/1*cHpl5ROayZZjEh_7ZExEPw.gif" rel="noopener"> TextInputLayout </a>包装的EditText。</p><figure class="kt ku kv kw fd lh"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="c334" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jd"> 3。反应视图</strong></p><p id="49cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这部分是这个食谱最重要的部分。我们将创建一个新类，姑且称之为<strong class="ih jd"> RxViewUtils </strong>。这个类将为我们连接这些点，所以我们不需要处理表单的所有可能的情况，并将帮助我们减少样板代码。</p><figure class="kt ku kv kw fd lh"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="d759" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的主要方法是<em class="lk"> verifyInput </em>方法。它接受一个输入视图，在这个例子中是一个TextInputLayout，使用RxAndroid库提供的方法从中创建一个可观察对象，并应用我们想要在这个输入中检查的<strong class="ih jd">动作</strong>。为了应用这个动作，我们使用<strong class="ih jd">合成</strong>方法(<a class="ae kp" href="https://twitter.com/danlew42" rel="noopener ugc nofollow" target="_blank"> @danlew42 </a>很好地解释了它<a class="ae kp" href="http://blog.danlew.net/2015/03/02/dont-break-the-chain/" rel="noopener ugc nofollow" target="_blank">在这里</a>)和<strong class="ih jd">应用</strong>变压器，这获得可观察的电流并应用以下方法。</p><ol class=""><li id="189f" class="jz ka hi ih b ii ij im in iq ll iu lm iy ln jc lo kh ki kj bi translated"><a class="ae kp" href="http://reactivex.io/documentation/operators/debounce.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih jd">去抖</strong> </a>，所以我们等待用户停止敲击后再验证输入</li><li id="553e" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc lo kh ki kj bi translated"><a class="ae kp" href="http://reactivex.io/documentation/operators/map.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih jd">映射</strong> </a>把发射源变成我们的动作，这样会返回真或假</li><li id="b299" class="jz ka hi ih b ii kk im kl iq km iu kn iy ko jc lo kh ki kj bi translated"><strong class="ih jd">在Android主线程上观察</strong>和<strong class="ih jd">订阅</strong>(我们在处理视图！)</li></ol><p id="4a10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来说说动作吧。action or <strong class="ih jd"> Func1 &lt; String，Boolean &gt; </strong> <em class="lk"> </em>将一个字符串作为参数(在我们的例子中是用户输入的最后一个文本)并应用所需的检查，最后如果输入正确则返回true，否则返回false。</p><p id="9e54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以自定义您的操作，应用您想要的规则，然后决定输入源是否有效。这些动作是处理表单案例的简单方法。</p><p id="18e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jd"> 4。全部订阅！</strong></p><p id="ac4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，对于您的每个<strong class="ih jd"> EditText </strong>或input view，使用期望的动作创建可观察对象，并使用<strong class="ih jd">combine test将它们放在一个单独的可观察对象中。</strong>每当创建的一个观察值发出时，CombineLatest将发出结果列表。如果它们都为“真”，那么我们启用提交按钮。</p><figure class="kt ku kv kw fd lh"><div class="bz dy l di"><div class="li lj l"/></div></figure><p id="c67f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的额外步骤是报告输入字段不正确。为此，我们使用<strong class="ih jd"> doOnNext </strong>函数。每当源可观察对象发出一个项目时，都会用一个布尔参数调用它。这个布尔值告诉我们这个源是否有一个有效的输入。所以我们只需更新视图并告诉用户有问题。</p><h2 id="b6db" class="je jf hi bd jg jh ji jj jk jl jm jn jo iq jp jq jr iu js jt ju iy jv jw jx jy bi translated">结果呢</h2><figure class="kt ku kv kw fd lh er es paragraph-image"><div class="er es lp"><img src="../Images/929ab49916590a44f8187f5ca8c91c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/1*yfMjx0bXn4vIPs7A531OEw.gif"/></div></figure><p id="0ea3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Twitter上找到我:<a class="ae kp" href="https://twitter.com/marxallski" rel="noopener ugc nofollow" target="_blank">@ marxalski</a>和<a class="ae kp" href="https://plus.google.com/u/1/+MarcelPint%C3%B3" rel="noopener ugc nofollow" target="_blank"> Google+ </a></p><p id="c7d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可能也会喜欢我关于<a class="ae kp" rel="noopener" href="/@marxallski/rxflux-android-architecture-94f77c857aa2#.3kj1933pn"> RxFlux </a>的新帖子</p><figure class="kt ku kv kw fd lh er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ls"><img src="../Images/c1192ebad88d6b1fc6ae1d6a2bc61154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJ6pLzJD9qnHRthas2vL-Q.jpeg"/></div></div></figure><p id="f537" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lk">发表于</em> <strong class="ih jd">创业、旅游癖和生活黑客</strong></p><div class="kt ku kv kw fd ab cb"><figure class="lx lh ly lz ma mb mc paragraph-image"><a href="http://supply.us9.list-manage.com/subscribe?u=310af6eb2240d299c7032ef6c&amp;id=d28d8861ad"><img src="../Images/de26c089e79a3a2a25d2b750ff6db50f.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*fSUxWFf6_qlAfAObKJuEAA.png"/></a></figure><figure class="lx lh ly lz ma mb mc paragraph-image"><a href="https://blog.growth.supply/"><img src="../Images/f47a578114e0a96bdfabc3a5400688d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Me4fgEZDDb-d8j41O5oKaQ.png"/></a></figure><figure class="lx lh ly lz ma mb mc paragraph-image"><a href="https://twitter.com/swlh_"><img src="../Images/c1351daa9c4f0c8ac516addb60c82f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*_DMWEyOz7IhTGGNb5tzA0g.png"/></a></figure></div><p id="5796" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi">-</p></div></div>    
</body>
</html>