<html>
<head>
<title>Classify emails into ham and spam using Naive Bayes Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用朴素贝叶斯分类器将电子邮件分类为垃圾邮件和垃圾邮件</h1>
<blockquote>原文：<a href="https://medium.com/swlh/classify-emails-into-ham-and-spam-using-naive-bayes-classifier-ffddd7faa1ef?source=collection_archive---------2-----------------------#2018-01-16">https://medium.com/swlh/classify-emails-into-ham-and-spam-using-naive-bayes-classifier-ffddd7faa1ef?source=collection_archive---------2-----------------------#2018-01-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="18fe" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">我们在建造什么？</h2></div><p id="8a5e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用朴素贝叶斯定理构建一个简单的电子邮件分类器。用PHP实现的算法可以在这里找到-<a class="ae jt" href="https://github.com/varunon9/naive-bayes-classifier" rel="noopener ugc nofollow" target="_blank">https://github.com/varunon9/naive-bayes-classifier</a></p><h2 id="9141" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated"><strong class="ak">稍微介绍一下- </strong></h2><blockquote class="kp kq kr"><p id="3d6f" class="ix iy ks iz b ja jb ij jc jd je im jf kt jh ji jj ku jl jm jn kv jp jq jr js hb bi translated">来自<a class="ae jt" href="https://en.wikipedia.org/wiki/Bayes%27_theorem" rel="noopener ugc nofollow" target="_blank">维基百科</a>:<br/><strong class="iz kw">P(A | B)</strong>=<strong class="iz kw">P(B | A)* P(A)/P(B)</strong>其中A和B是事件，<strong class="iz kw"> P(B)！= 0 </strong> <br/> <strong class="iz kw"> P(A | B) </strong>是条件概率:假设B为真，事件A发生的可能性。<br/> <strong class="iz kw"> P(B | A) </strong>也是条件概率:假设A为真，事件B发生的可能性。<br/> <strong class="iz kw"> P(A) </strong>和<strong class="iz kw"> P(B) </strong>是彼此独立地观察到A和B的概率，这就是所谓的边际概率。</p></blockquote><p id="4401" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们假设我们有几个已经被分类为垃圾邮件的文档(<strong class="iz kw">训练集</strong>)。因此“<em class="ks">这封邮件是垃圾邮件还是垃圾邮件</em>的问题也可以表述为- <em class="ks">给定包含以下文档的最新邮件是垃圾邮件或垃圾邮件的概率是多少？</em>(此处文档为邮件中的部分文字)。数学上我们可以-</p><blockquote class="kp kq kr"><p id="9cb9" class="ix iy ks iz b ja jb ij jc jd je im jf kt jh ji jj ku jl jm jn kv jp jq jr js hb bi translated"><strong class="iz kw"> P(ham | bodyText) </strong> =假定电子邮件包含document- bodyText(假设bodyText =电子邮件的内容)<br/> <strong class="iz kw"> P(垃圾邮件| bodyText) </strong> =假定电子邮件包含document-body text<br/><strong class="iz kw">P(ham | bodyText) = (P(ham)* P(bodyText | ham))/P(body text)<br/>P(垃圾邮件| body text)=(P(垃圾邮件)* P(body text |垃圾邮件)</strong></p></blockquote><h2 id="c5f7" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">准备训练集-</h2><p id="e081" class="pw-post-body-paragraph ix iy hi iz b ja kx ij jc jd ky im jf jg kz ji jj jk la jm jn jo lb jq jr js hb bi translated">我们必须有一个训练数据集才能让我们的分类器工作。我们将使用MySql作为数据库来存储我们的训练集。让我们从数据库模式开始。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es lc"><img src="../Images/abb0c0e8bbdb0a8b1a6dc20ab32ed0d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*97U9J3EwORq66hV22onVPQ.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx">training set database schema</figcaption></figure><p id="a779" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将创建两个表。</p><ol class=""><li id="f00e" class="lo lp hi iz b ja jb jd je jg lq jk lr jo ls js lt lu lv lw bi translated">带列<code class="du lx ly lz ma b">document(text)</code>和<code class="du lx ly lz ma b">category(varchar)</code>的训练集。该表将保存所有电子邮件及其类别，即垃圾邮件或垃圾邮件。</li><li id="949e" class="lo lp hi iz b ja mb jd mc jg md jk me jo mf js lt lu lv lw bi translated">词频有<code class="du lx ly lz ma b">word(varchar)</code>、<code class="du lx ly lz ma b">count(int)</code>和<code class="du lx ly lz ma b">category(varchar)</code>三栏。该表将保存目前看到的所有单词及其计数和类别。</li></ol><p id="df66" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们用下面的数据集训练我们的分类器。(我将使用https://github.com/varunon9/naive-bayes-classifier的<a class="ae jt" href="https://github.com/varunon9/naive-bayes-classifier" rel="noopener ugc nofollow" target="_blank">应用程序来训练我们的分类器)。</a></p><ol class=""><li id="93fa" class="lo lp hi iz b ja jb jd je jg lq jk lr jo ls js lt lu lv lw bi translated">祝您过得愉快！通过Paytm预订Oyo客房，最高可享受30%的折扣+20%的固定返现。(垃圾邮件)</li><li id="1dad" class="lo lp hi iz b ja mb jd mc jg md jk me jo mf js lt lu lv lw bi translated">让我们谈论时尚！购买背包、手表、香水、太阳镜等产品可获得40%的统一返现。(垃圾邮件)</li><li id="8252" class="lo lp hi iz b ja mb jd mc jg md jk me jo mf js lt lu lv lw bi translated">产品公司为full stack | back end | Frontend-Bangalore提供的机会。(火腿)</li><li id="66e8" class="lo lp hi iz b ja mb jd mc jg md jk me jo mf js lt lu lv lw bi translated">Javascript开发人员，班加罗尔的全栈开发人员-迫切需要。(火腿)</li></ol><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/60ba35a86e225f56015c8be801e305f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gHxF3fVhiNxHvu4kWTonoQ.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Database after training with first data set.</figcaption></figure><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es ml"><img src="../Images/b70c09c4e952b83f38e276a4b4cb3525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3AXO_ajbXYAVf1xK5v5bA.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">Database after training with first and second data sets.</figcaption></figure><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mm"><img src="../Images/a64a0bf110409f5c570da10501742a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24k12eZUTPyPirQ37Rn8Pw.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx">trainingSet table data after training with all 4 data sets.</figcaption></figure><figure class="ld le lf lg fd lh er es paragraph-image"><div class="er es mn"><img src="../Images/aafee687545a7bfd2582a85990130e64.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*cVV1OoNeYu9H-Fz2blMTFQ.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx">wordFrequency table data after training with all 4 data sets.</figcaption></figure><h2 id="a267" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">实现算法-</h2><p id="6ec2" class="pw-post-body-paragraph ix iy hi iz b ja kx ij jc jd ky im jf jg kz ji jj jk la jm jn jo lb jq jr js hb bi translated">我们的分类器将实现以下伪代码-</p><p id="40f7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">if(P(ham | body text)&gt; P(spam | body text)){<br/>返回‘ham’；<br/> } else { <br/>返回‘垃圾邮件’；<br/> }</p><blockquote class="kp kq kr"><p id="c424" class="ix iy ks iz b ja jb ij jc jd je im jf kt jh ji jj ku jl jm jn kv jp jq jr js hb bi translated"><strong class="iz kw">P(ham | body text)=(P(ham)* P(bodyText | ham))/P(body text)<br/>P(spam | body text)=(P(spam)* P(body text | spam)/P(body text)<br/></strong><em class="hi">由于P(body text)是常量，在两个表达式中是常见的，所以我们可以避开。请注意，我们的目标不是计算实际概率，而只是比较。<br/> </em> <strong class="iz kw"> P(ham) <em class="hi"> = </em>属于ham类别的文档数/文档总数<br/> P(spam) <em class="hi"> = </em>属于spam类别的文档数/文档总数<br/> </strong> <em class="hi">为了计算上述两个概率，我们将使用trainingSet表。<br/></em><strong class="iz kw">P(body text | spam)= P(word 1 | spam)* P(word 2 | spam)*…<br/>P(body text | ham)= P(word 1 | ham)* P(word 2 | ham)*…<br/></strong><em class="hi">要计算以上两个概率，我们就用词频表。这里，单词1、单词2、单词3到单词n是正文中的总单词数。<br/> </em> <strong class="iz kw"> P(word1 | spam) =属于垃圾邮件类别的word1的计数/属于垃圾邮件类别的总计数。<br/> P(word1 | ham) =属于ham类别的word1的计数/属于ham类别的单词总数。</strong></p></blockquote><h2 id="63c2" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">需要注意的事项-</h2><p id="5703" class="pw-post-body-paragraph ix iy hi iz b ja kx ij jc jd ky im jf jg kz ji jj jk la jm jn jo lb jq jr js hb bi translated">如果我们的分类器检测到训练数据集中不存在的新单词，会发生什么？在这种情况下，<code class="du lx ly lz ma b">P(new-word | ham)</code>或<code class="du lx ly lz ma b">P(new-word | spam)</code>将为0，使得所有乘积等于0。</p><p id="bb69" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了解决这个问题，我们将两边都用圆木。新的伪代码将是-</p><p id="b8d4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">if(log(P(ham | body text))&gt; log(P(spam | body text)){<br/>返回' ham '；<br/> } else { <br/>返回‘垃圾邮件’；<br/> }</p><p id="68b0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz kw"><em class="ks">log(P(ham | body text))= log(P(ham))+log(P(body text | ham))<br/>= log(P(ham))+log(P(word 1 | ham))+log(P(word 2 | ham))</em></strong>…</p><p id="9e40" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是等等，我们的问题还是没有解决。如果我们的分类器遇到训练数据集中不存在的新词，则P(新词|类别)将为0，log(0)未定义。为了解决这个问题，我们将使用拉普拉斯平滑。现在我们要-</p><p id="7d7f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz kw"> <em class="ks"> P(词1 | ham) =(属于类别ham的词1的计数+ 1) /(属于ham的词的总计数+训练数据集即我们的数据库中的不同词的数量)</em> </strong></p><p id="0274" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz kw"> <em class="ks"> P(单词1 |垃圾邮件)=(属于垃圾邮件类别的单词1的计数+ 1) /(属于垃圾邮件的单词的总计数+训练数据集即我们的数据库中的不同单词的数量)</em> </strong></p><p id="5840" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了进一步改进分类器，我们可以对正文(即电子邮件的内容)进行标记。</p><figure class="ld le lf lg fd lh"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="bf26" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">测试我们的分类器-</h2><p id="d844" class="pw-post-body-paragraph ix iy hi iz b ja kx ij jc jd ky im jf jg kz ji jj jk la jm jn jo lb jq jr js hb bi translated"><strong class="iz kw">$ classifier-&gt;classifier('扫描Paytm二维码支付&amp;赢100%返现')；</strong> //垃圾邮件</p><p id="bc68" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz kw">$ classifier-&gt;classifier(' Re:申请Fullstack开发者')；</strong> //火腿</p></div><div class="ab cl mq mr gp ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="hb hc hd he hf"><h2 id="6d03" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">结论-</h2><p id="ad54" class="pw-post-body-paragraph ix iy hi iz b ja kx ij jc jd ky im jf jg kz ji jj jk la jm jn jo lb jq jr js hb bi translated">假设我们的训练数据集是好的，朴素贝叶斯分类器易于实现并提供非常好的结果。它还可以用于对情绪进行分类，即快乐/悲伤/中性，或者对推文中的情绪进行分类，即积极/消极/中性等。如果您发现任何错误或问题，请在<a class="ae jt" href="https://github.com/varunon9/naive-bayes-classifier" rel="noopener ugc nofollow" target="_blank">https://github.com/varunon9/naive-bayes-classifier</a>创建github问题。</p><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mx"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">这个故事发表在<a class="ae jt" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的企业家出版物，拥有293，189+人。</h2><h2 id="7945" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">在这里订阅接收<a class="ae jt" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="ld le lf lg fd lh er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mx"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>