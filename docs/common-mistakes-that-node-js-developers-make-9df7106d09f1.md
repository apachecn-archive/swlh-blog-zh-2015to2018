# Node.js 开发人员常犯的错误

> 原文：<https://medium.com/swlh/common-mistakes-that-node-js-developers-make-9df7106d09f1>

![](img/de485a19f3ca56a16d2b6d337b24a02e.png)

Common Mistakes That Node.js Developers Make

ode.js 给了我们[最先进的网络应用](https://www.cognitiveclouds.com/software-product-development-portfolio/web-crawler-and-scraper-development-consumer-data-science)，它提供了双向、实时的连接，客户端和服务器可以互相通信。这与传统的 web 响应范例形成了鲜明的对比，在传统的 web 响应范例中，只有客户端发起通信。这与 ASP.NET 的 Ruby On Rails T5 和 T7 非常相似。它由谷歌速度极快的 V8 驱动，利用 JavaScript，轻量级内置 web 服务器作为主要语言，并通过节点包管理器管理大量插件，允许用户定制应用程序以满足他们的需求。大多数这听起来像任何其他好的技术，但它带有某些特性，这些特性使它成为 web 开发人员的流行选择，以构建广泛的 web 应用程序。

现在，在围绕不同编程语言的优缺点的辩论中，我们往往容易忽略的是，围绕某些问题的大多数批评都源于对语言的不正确使用。批评通常集中在[安全的代码编写实践](https://www.cognitiveclouds.com/insights/what-are-the-best-practices-for-node-js-development/)以及 Node.js 会变得多复杂。即便如此，该平台已经存在了一段时间，并被用于构建大量复杂而健壮的 web 服务。然而，像任何其他平台一样，Node.js 容易受到开发人员问题的影响。今天，我们将看看 Node.js 新手开发人员经常犯的一些常见错误。

![](img/4bac686e231d609d9133bc94bdf0de8b.png)

*Common Mistakes That Node.js Developers Make*

# 1.阻止事件循环

作为单线程环境，应用程序的任何两个部分都不能并行运行。简而言之，由于 Node.js 运行在单线程上，任何阻塞事件循环的东西都会阻塞所有东西。这里，并发是通过异步处理输入输出操作来实现的。例如，允许 Node.js 关注应用程序的其他部分的是从 Node.js 到数据库引擎的获取一些文档的请求。然而，阻止事件循环所需要的只是 Node.js 实例中的一段受 CPU 限制的代码，其中连接了许多客户端，使得所有客户端都在等待。这个问题没有明确的解决办法，只能逐个解决。主要思想是不要在前端的 Node.js 实例中做 CPU 密集型工作，这些实例是客户端并发连接的。

# 2.多次调用回调

众所周知，JavaScript 依赖于回调。过去，回调是 Node.js 中代码的异步元素相互通信的唯一方式，直到出现了承诺。软件包开发人员仍然围绕回调设计他们的 API，所以回调仍然在大量使用。开发人员在使用回调时犯的一个常见错误是多次调用它们。看，回调并不是当前函数的终点。一些开发人员选择在回调之前添加一个 return 来避免多次调用。在大多数异步函数中，return 语句几乎没有意义，因此有助于避免这个问题。留意这个错误是避免它的唯一方法。

# 3.回调不会同步运行，不要期望它们会同步运行

带有回调的异步编程并不是 JavaScript 和 Node.js 所独有的。尽管如此，它们的流行还是功不可没。我们已经习惯了其他编程语言中可预测的执行顺序，除非给出在语句之间跳转的指令，否则两条语句将一条接一条地执行。尽管如此，这些通常仅限于条件语句、函数调用和循环语句。现在，在 JavaScript 中，回调一个特定的函数，在它等待的任务完成之前，可能不会很好地运行。当前函数将不间断地执行和运行，直到结束。Node.js 开发人员必须确保，调用后必须发生的下一个任务必须从其中调用。

# 4.异步错误处理

看起来回调是大多数问题的原因。同样，这里的问题是异步行为。如果 V8 引擎是 Node.js 的心脏，那么回调就是实现跨模块和应用的异步控制的平衡、非阻塞流的血管。引入“错误优先”回调协议是为了确保回调可以大规模工作。现在，JavaScript(其背后的语言)可以在 try-catch 块中抛出和捕获异常。但是，在异步情况下，try-catch 不会像您预期的那样运行。例如，如果您想用一个大的 try-catch 块来保护一大块包含大量异步活动的代码，这可能行不通。您会看到包含 try-catch 块的作用域可能已经脱离上下文很久了，因为它仍然能够捕捉回调中抛出的错误。这就是为什么大多数节点？Js 开发人员遵循回调函数所有参数的模式，其中所有回调的第一个参数都保留给一个错误对象。

# 5.深度嵌套回调

或者通常所说的“回调地狱”不仅仅是 Node.js 的问题。任务越复杂，问题就越糟糕。通过以这种方式嵌套回调，我们最终会得到难以阅读、容易出错且难以维护的代码。因此，大多数人将“回调地狱”作为不喜欢 Node.js 的关键点，但是大多数人认为回调嵌套是不可避免的。但是你看，事实并非如此。有足够多的解决方案可以让你的代码保持整洁，比如使用 async、promises 和 generators 这样的控制流模块。

# 6.使用 console.log 进行调试

在 Node.js 中，“console.log”允许您在控制台上打印任何内容。它将打印您作为 JavaScript 对象文字传递的任何对象。它接受并打印任意数量的参数，所有参数都整齐地用空格隔开。因此，我们理解为什么作为一名开发人员，当出现问题时，很容易在某些地方插入 console.log 并进行调试。一旦您发现了问题，您就可以移除剩余的 console.log 调试并继续前进。这里的问题是下一个开发者，可能就是你，可能会出现并重复这个过程。这就是 debug 这样的模块存在的原因。使用 debug 函数，而不是插入和删除“console.log”。当下一个开发人员试图解决问题时，他或她只需使用 DEBUG 环境变量启动应用程序。

# 7.JavaScript 中没有任何整数数据类型

数字在 JavaScript 中是浮点。通常不会遇到大到超出 float 限制的数字，所以你不会认为这是个问题。这正是与此相关的错误发生的时候。一旦浮动的极限被突破，麻烦就会出现，计算也会出错。此外，运算符对浮点数和整数的处理方式也不同。记住这一点可以确保你的函数的工作方式没有问题，并得到想要的结果。您可能不经常处理大数，但是如果您经常处理，有足够多的大整数库，它们实现了对大精度数的必要数学运算。

# 8.不虔诚地测试

如果你没有为应用程序编写任何测试，那么你的应用程序就没有完成。它在规则手册中，没有理由跳过这一条，考虑到有许多工具可以使这个过程变得更容易。如果您不确定如何开始编写测试，您可以浏览 Github 上流行的节点项目或在线查找教程。

# 9.零监控或剖析

不监控或分析节点应用程序会让您处于黑暗中。无论 Node.js 代码是处于生产模式还是在本地开发环境中运行，一个可以编排您的程序的监督程序监视器都是非常有用的。有些专有服务会为你处理这些事情，比如 New Relic、StrongLoop 或 Concurix、AppDynamics。无论您选择什么，都要确保您始终了解您的应用程序的状态。

*原载于* [*产品洞察博客*](https://www.cognitiveclouds.com/insights/) *来自 cognitive clouds:Top*[*Node JS 开发公司*](https://www.cognitiveclouds.com/custom-software-development-services/node-js-development-company)

![](img/731acf26f5d44fdc58d99a6388fe935d.png)

## 这个故事发表在 [The Startup](https://medium.com/swlh) 上，这是 Medium 最大的企业家出版物，拥有 293，189+人。

## 在此订阅接收[我们的头条新闻](http://growthsupply.com/the-startup-newsletter/)。

![](img/731acf26f5d44fdc58d99a6388fe935d.png)