<html>
<head>
<title>Only Numpy: Why we need Activation Function (Non-Linearity), in Deep Neural Network — With Interactive Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Only Numpy:为什么我们在深度神经网络中需要激活函数(非线性)——使用交互式代码</h1>
<blockquote>原文：<a href="https://medium.com/swlh/only-numpy-why-we-need-activation-function-non-linearity-in-deep-neural-network-with-529e928820bc#2018-01-16">https://medium.com/swlh/only-numpy-why-we-need-activation-function-non-linearity-in-deep-neural-network-with-529e928820bc#2018-01-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f7cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以今天，我不想做太复杂的事情，而是用代码做一个简单的证明。让我们进入正题，为什么我们需要激活功能？</p><h2 id="94f6" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated"><strong class="ak"> <em class="jy">非线性</em> </strong></h2><p id="3659" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">这就是我们需要激活功能，因为上述原因。如果你想知道详情，请阅读这篇博文。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="9965" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih kl">网络架构+前馈过程</strong></p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es km"><img src="../Images/42e34c961e17e4f8f396f31ba9b75e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*POV6QH9Jfm6QQskWU3k-OQ.jpeg"/></div></div></figure><p id="58e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以这里有两点需要注意，<br/> 1。我们正在使用IDEN激活功能，如上所示。它只返回输入的内容。而求导只是1。下面是一个python实现。</p><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="8ece" class="jd je hi kz b fi ld le l lf lg">def identity_act(x):<br/>      return x<br/>  <br/>def d_identity_act(x):<br/>  return 1</span></pre><p id="f0c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.如右图所示，这是标准的神经网络，没有什么特别之处。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es km"><img src="../Images/3b01656323bc7e15460893df85f3405b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DtLn_zzDNs83tf9XIX8tdA.jpeg"/></div></div></figure><p id="8fb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，我们使用L2成本函数。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es km"><img src="../Images/8c8305b7cf6a4eecc5c54585af4b935c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpZicncUc-cMAo59-F1sLw.jpeg"/></div></div></figure><p id="0ba1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，如上所述，我们拥有的3个权重的维度是(3*4)、(4*10)和(10*1)。我们的输入矩阵如下所示。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div class="er es lh"><img src="../Images/072023b11a20f1bf5755f1b106f80717.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*pDy9Kb9dXdJWf6QQSb99HQ.png"/></div></figure><pre class="kn ko kp kq fd ky kz la lb aw lc bi"><span id="7a75" class="jd je hi kz b fi ld le l lf lg">So if we do the math.<br/>Layer_1 = x.dot(w1) → (4*3)(3*4) →(4*4)<br/>Layer_1_act = IDEN(Layer_1) →(4*4)</span><span id="aa87" class="jd je hi kz b fi li le l lf lg">Layer_2 = Layer_1_act.dot(w2) → (4*4)(4*10) →(4*10)<br/>Layer_2_act = IDEN(Layer_2) → (4*10)</span><span id="0f93" class="jd je hi kz b fi li le l lf lg">Layer_3 = Layer_2_act.dot(w3) →(4*10)(10*1) →(4*1)<br/>Layer_3_act = IDEN(Layer_3) → (4*1)</span><span id="3005" class="jd je hi kz b fi li le l lf lg">Cost = np.square(Layer_3_act-Y).sum() * 0.5</span></pre></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="1f05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih kl">反向传播</strong></p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es km"><img src="../Images/ffa00c6ae29fa3906b1b472a27408436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJrFxmkja0CyvfFnDNf6Uw.jpeg"/></div></div></figure><p id="b75b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">带<strong class="ih kl">矢量化的标准反向传播，</strong>没什么特别的。但是请注意我用红色写的地方，这些是我们对激活函数IDEN求导的地方，它给出1。</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="e5f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih kl">前馈版本2 </strong></p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es km"><img src="../Images/0af9bfd9f0f6428442e66dcf39985b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjKwr2spRlTPvKwJWEuy5g.jpeg"/></div></div></figure><p id="dd36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，因为我们的激活函数是线性的。我们可以用一个巧妙的技巧把整个网络变成一个简单的数学行！</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><p id="aaf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih kl">交互代码</strong></p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lj"><img src="../Images/e2a1d943cd816c373fba3361f9bc9200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZxyW1KepyCK72qnzzDebg.png"/></div></div></figure><p id="61bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里是代码的<a class="ae lk" href="https://trinket.io/python3/55549b9fea" rel="noopener ugc nofollow" target="_blank">链接。</a></p><p id="56da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们一个接一个地看看每一部分。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ll"><img src="../Images/2909a80f5eafc3f6bedcd1e66ea44606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G24pgOJ0s_eMgG8HR-bvTg.png"/></div></div></figure><p id="f862" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面是标准的前馈和反向传播，没什么特别的，下面是结果。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div class="er es lm"><img src="../Images/4601691b8145598c14c17ab3a84f4f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*L3Y8wAS0B1GLthir0mm5CQ.png"/></div></figure><p id="88cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如看到的100%的准确性，(当四舍五入)，现在让有趣的东西。让我们计算K值。</p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ln"><img src="../Images/fdf59e809d0e7368fad2b4a1d3ceca7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E3TXMIH1ZjsqheOnZ7bMKQ.png"/></div></div></figure><p id="0c6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，我们可以通过简单的点积来计算K值，只需执行x.dot(k)即可获得相同的结果！</p></div><div class="ab cl ke kf gp kg" role="separator"><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj kk"/><span class="kh bw bk ki kj"/></div><div class="hb hc hd he hf"><h2 id="2bbb" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">最后的话</h2><p id="a43f" class="pw-post-body-paragraph if ig hi ih b ii jz ik il im ka io ip iq kb is it iu kc iw ix iy kd ja jb jc hb bi translated">如果发现任何错误，请发电子邮件到jae.duk.seo@gmail.com找我。</p><p id="ccc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与此同时，请在我的推特<a class="ae lk" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>关注我，并访问<a class="ae lk" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或我的<a class="ae lk" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解更多内容。如果你感兴趣的话，我还在简单的RNN <a class="ae lk" rel="noopener" href="/@SeoJaeDuk/only-numpy-vanilla-recurrent-neural-network-with-activation-deriving-back-propagation-through-time-4110964a9316">上做了反向传播。</a></p><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lo"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">这个故事发表在<a class="ae lk" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的企业家出版物，拥有293，189+人。</h2><h2 id="7945" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">在这里订阅接收<a class="ae lk" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="kn ko kp kq fd kr er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lo"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>