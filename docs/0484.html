<html>
<head>
<title>Is it brunch time?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">是早午餐时间了吗？</h1>
<blockquote>原文：<a href="https://medium.com/swlh/is-it-brunch-time-ffe3adf485d8#2016-06-24">https://medium.com/swlh/is-it-brunch-time-ffe3adf485d8#2016-06-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="97f6" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">背景</h2></div><p id="ede3" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">几年前，作为一个玩笑，我创造了isitbrunchtimeyet.com。从那以后，它主要被用作邀请人们吃早午餐的一种有趣和/或有点被动的方式。当我创建它时，我任意地将早午餐时间设置为上午10:15到11:45。正是这个决定把我们带到了这里——我想做得比武断更好。</p><h2 id="6a7f" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">假设</h2><p id="9d26" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">Twitter是一个允许用户“获得对你重要的实时更新”的平台。[2]如果我们假设人们通常在做这些事情的时候发推文，那么我们可以假设包含“早午餐”的推文通常发生在那个人正在吃早午餐的时候。因此，如果我们在足够长的时间内收集足够多的推文，并分析它们被推文的时间，我们就可以推断出早午餐的具体时间范围。</p><h2 id="7ee4" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated"><strong class="ak">数据</strong></h2><p id="a2da" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">我们从使用Twitter流API开始。这个API允许我们订阅搜索词，例如“brunch ”,并实时获取发送到我们程序的与该词匹配的任何tweet。我们不仅收集了“早午餐”的推文，还收集了包含“早餐”、“午餐”和“晚餐”的推文作为对照(我们将在后面回顾)。我们允许该计划从2015年6月1日运行到2016年5月31日，产生了1亿多条推文供分析。Twitter是一个全球平台，所以我们必须做一些额外的工作来了解一条特定推文发生的时间。在发推特的时候，我们分析了发推特的人的时区和任何附加的地理位置数据(如果有的话)。利用这些数据，我们对每条推文的本地化时间做了一个明智的估计。</p><p id="c2f0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，我们能够按当地时间细分推文数量:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/852404678135b6b4fc34232bc288e2c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HkBnlVAQERMvABqTfHZ01Q.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx">Tweets containing the term brunch with the hour localized based on inferred timezone of the tweeter</figcaption></figure></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h2 id="a265" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated"><strong class="ak">解决方案1:天真的解决方案</strong></h2><p id="50b1" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">简单地看一下上面的柱状图，你会很快注意到上午11点是最受欢迎的发布早午餐微博的时间——这意味着上午11点到下午12点肯定是早午餐时间，对吗？</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/7931a059756b202c5a08d5ba3529000b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gau39iG7jUPfqqK_4xADFw.png"/></div></div></figure><p id="a2c1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一个非常合理的结论。然而，我们认为还有改进的余地。首先，这种解决方案缺乏任何真正的保真度。早午餐不太可能在上午11点准时开始，在下午12点准时结束。第二，如果我们再次查看直方图，您可以看到中午12点的活动非常接近上午11点。这告诉我们，很多早午餐活动发生在上午11点以后，而这个解决方案没有考虑到这一点。</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h2 id="cd44" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">解决方案2:概率密度函数</h2><p id="03fe" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">因为我们正在可视化一个直方图，所以跳到一个分布函数进行进一步分析是合乎逻辑的。由于我们的数据有正偏差，我们将着眼于概率密度函数(PDF)。首先，我们计算对数正态分布[5] PDF(下面的红线)并定位该函数的最大值点(众数)。我们选择对数正态分布而不是正态分布，因为它似乎更符合数据。然后，我们确定一个范围，在这个范围内，所有推文的很大一部分，比如说1/4 (25%)，都围绕着这个最大值出现:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lr"><img src="../Images/404de9b131714731eafbc19dd166f8ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4gI2h4_XSXQACFCytxtcgA.png"/></div></div></figure><p id="f30d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个策略让我们的早午餐时间从上午9:25到下午12:24。然而，这种策略有一些缺点。首先，25%的发生率是一个任意值。不会比30%或20%或任何其他数字更好。第二，对数正态PDF很大程度上取决于我们如何看待x轴。在这个例子中，我们从凌晨3点开始，我们之所以选择这个时间，是因为它通常是我们的数据集中tweet计数最低的时间(否则它会有点双峰)。如果我们从x轴开始，比如说12点，我们会得到一条不同的曲线。第三，看这张图<em class="ls">感觉</em>与我们的第一个解决方案有类似的问题，因为它没有真正捕捉到下午早些时候活动的长尾。在我们寻求客观答案的过程中，这些任意的假设都是不可接受的权衡。</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h2 id="31e0" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">解决方案3:样条插值</h2><p id="117a" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">样条允许我们通过许多不同的点创建一条平滑的曲线。让我们画一条每小时的曲线，并绘制成图表:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/a6612e233fc18c42004a8a0c4307798b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jzHEkocl1oDvLZ8Pj4cNWQ.png"/></div></div></figure><p id="2081" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们看这条曲线，我们可以看到最大值与我们根据直方图直观假设的早午餐发生的位置非常吻合。让我们给这个最大值取个名字，早午餐点怎么样？早午餐时间可以定义为:一天中早午餐最多的确切时间。根据我们的数据，时间是上午11:56。</p><blockquote class="lt"><p id="856a" class="lu lv hi hj lw lx ly lz ma mb mc js dx translated">早午餐时间——一天中早午餐最多的确切时间</p></blockquote><figure class="md me mf mg mh kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/2c5a9130908771e3c27517ee749276e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oLeWaPLxw3edw8HjtxNBGQ.png"/></div></div></figure><p id="4259" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，这似乎是一个很好的答案！然而，我们正在寻找一个<em class="ls">时间范围</em>，而不仅仅是一个时间点。那么我们如何从样条曲线计算出一个范围呢？还记得高中的微积分吗？这是你的教授承诺的微积分的真实使用案例！让我们看看导数:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/f49a0748117c4c62ef2fb483390c3fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2LQqscRjRSUSCY4_N9kwDQ.png"/></div></div></figure><p id="1ba7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">手头没有微积分书？什么是导数？函数的导数将给出函数在任意给定时间点的变化率(也称为斜率，也称为y = <em class="ls"> m </em> x + b中的<em class="ls"> m </em>)。[4]它帮助我们理解一个函数的加速。让我们找出斜率最高和最低的切线:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/c8017ef9e581698b8f59a11e4853c55b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rwmqVWR-iSyvWY4BOo8QpA.png"/></div></div></figure><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/b39adaa0a7f4a7bf43f7959a7c6f45d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j72n7X8s5AOmVTdi807clg.png"/></div></div></figure><p id="5b08" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这个最大斜率下，早午餐推文的数量正经历着最高的正变化率:人们正在加快他们关于早午餐的推文速度——最大程度地踩油门。在最小斜率时，早午餐推文的数量正经历着最高的负变化率:人们放慢了他们的推文速度<em class="ls">——使劲踩刹车踏板。</em>利用这两点，我们得到早午餐时间:上午10:01到下午1:40。</p><p id="c532" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们最喜欢这种方法有几个原因:</p><ul class=""><li id="083c" class="mi mj hi iz b ja jb jd je jg mk jk ml jo mm js mn mo mp mq bi translated">它似乎抓住了我们在第一个解决方案中的“直觉”——当你想象它时，它<em class="ls">感觉</em>是正确的。</li><li id="6db2" class="mi mj hi iz b ja mr jd ms jg mt jk mu jo mv js mn mo mp mq bi translated">它使用一条样条线，即使x轴平移，该样条线也将保持非常一致。</li><li id="3bc5" class="mi mj hi iz b ja mr jd ms jg mt jk mu jo mv js mn mo mp mq bi translated">它基于我们非常熟悉的概念——加速和减速</li></ul><p id="26be" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是我们怎么知道它是否正确呢？让我们将解决方案应用于其他术语，并观察它的表现。</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><h2 id="1149" class="ju jv hi bd jw jx jy jz ka kb kc kd ke jg kf kg kh jk ki kj kk jo kl km kn ko bi translated">比较数据</h2><p id="f8f2" class="pw-post-body-paragraph ix iy hi iz b ja kp ij jc jd kq im jf jg kr ji jj jk ks jm jn jo kt jq jr js hb bi translated">为了进行比较，我们来看看“早餐”和“午餐”推文的样条曲线:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es mw"><img src="../Images/5560658e927913f3685402e0cda0759c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vq5tYkfxfQxr0zT5Z3cokg.png"/></div></div></figure><p id="bebe" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于“早餐”和“午餐”在twitter上比“早午餐”更受欢迎，让我们根据频率修改这些曲线，这样更容易看出它们之间的区别。然后，让我们也应用上面的解决方案来了解它们之间的比较:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lr"><img src="../Images/be0672e4aaeca621ce2be665d134b2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i28wpk-UQQFYwaG3m_XPug.png"/></div></div></figure><p id="a779" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们有了一些结果:</p><ul class=""><li id="eeb5" class="mi mj hi iz b ja jb jd je jg mk jk ml jo mm js mn mo mp mq bi translated">早餐时间:上午7:50至11:55</li><li id="45db" class="mi mj hi iz b ja mr jd ms jg mt jk mu jo mv js mn mo mp mq bi translated">早午餐:上午10:01至下午1:40</li><li id="4e94" class="mi mj hi iz b ja mr jd ms jg mt jk mu jo mv js mn mo mp mq bi translated">午餐时间:上午11:40至下午2:25</li></ul><p id="45cd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">就这样了——早午餐的正式时间是从上午10:01到下午1:40。有趣的是，早餐的结束和午餐的开始相距不超过15分钟。有趣的是，早午餐时间点也在同一时间段。两者都给了这个解决方案至少一点点的肯定。</p><p id="6801" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在去吃些早午餐吧！</p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="35d2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz mx">TL；根据1亿多条推文和分析，dr-Brunch的官方时间是上午10:01到下午1:40。</strong></p></div><div class="ab cl lk ll gp lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="hb hc hd he hf"><p id="e07e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所有的分析和图表都是使用pandas/matplotlib在python中完成的</p><p id="08e7" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">来源:<a class="ae jt" href="https://github.com/bjacobso/brunch" rel="noopener ugc nofollow" target="_blank">https://github.com/bjacobso/brunch</a></p><p id="637d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[1]深受isitchristmas.com和isitlunchtimeyet.com的启发</p><p id="b4ed" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[2]<a class="ae jt" href="https://about.twitter.com/" rel="noopener ugc nofollow" target="_blank">https://about.twitter.com/</a></p><p id="badf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae jt" href="https://en.wikipedia.org/wiki/Spline_interpolation" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Spline_interpolation</a></p><p id="77f1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae jt" href="https://en.wikipedia.org/wiki/Derivative" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Derivative</a></p><p id="0adb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[5] <a class="ae jt" href="https://www.reddit.com/r/dataisbeautiful/comments/4q4c1n/is_it_brunch_time_analyzing_tweets_to_get_an/d4q7k5g" rel="noopener ugc nofollow" target="_blank">来自Reddit的出色反馈</a></p></div></div>    
</body>
</html>