<html>
<head>
<title>Only Numpy: Decoupled Recurrent Neural Network, modified NN from Google Brain, Implementation with Interactive Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Only Numpy:解耦递归神经网络，从Google Brain修改NN，用交互式代码实现</h1>
<blockquote>原文：<a href="https://medium.com/swlh/only-numpy-decoupled-recurrent-neural-network-modified-nn-from-google-brain-implementation-with-7f328e7899e6?source=collection_archive---------13-----------------------#2018-02-03">https://medium.com/swlh/only-numpy-decoupled-recurrent-neural-network-modified-nn-from-google-brain-implementation-with-7f328e7899e6?source=collection_archive---------13-----------------------#2018-02-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cec5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我和我的一个朋友<a class="ae jd" href="https://www.facebook.com/michael.a.pacheco9" rel="noopener ugc nofollow" target="_blank">迈克尔</a>聊了聊，他也对机器学习非常感兴趣，关于谷歌大脑的<a class="ae jd" href="https://arxiv.org/pdf/1608.05343.pdf" rel="noopener ugc nofollow" target="_blank">使用合成梯度</a>去耦合神经接口。他启发了我这个想法，解耦递归神经网络，我们能做到吗？但更重要的是，它的表现会好吗？</p><p id="e8da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在继续讨论IamTrask之前，Google Brain很好地介绍了解耦神经网络。所以<a class="ae jd" href="https://iamtrask.github.io/2017/03/21/synthetic-gradients/" rel="noopener ugc nofollow" target="_blank">看看他的tutoria </a> l，太神奇了。我也对NN进行了蹩脚的解耦，这里是T7。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="4ce0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">准备数据/声明超级参数</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/af9a12629256e55126d95ffeec67ba53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXezGwbo8p8TAZB77hEjNQ.png"/></div></div></figure><p id="d1a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，我们将仅对图像0和1的MNIST数据集执行简单的分类任务。我们将把它作为矢量格式处理，而不是(28*28)图像格式。另外，请注意绿框区域，因为那是我们的两个梯度，耶稣告诉我们真实的梯度。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="810e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">网络架构</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jy"><img src="../Images/48b4f31d2e4dba7c945bf4088943ed0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qfsqMWWPneNC93-_zguPQ.jpeg"/></div></div></figure><p id="09d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上图，非常简单明了。在搬到LSTM或GRU之前，我想用香草RNN迈出我的第一小步。但是你可以看到绿色框中突出显示的，我们有两个甲骨文，告诉我们什么是真正的梯度。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="31bc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">前馈/反向传播/梯度更新</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jy"><img src="../Images/fdc2c2e032cc53146cda0c276b0b23e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LuuLmBVY4vSsxJEbKC08-g.jpeg"/></div></div></figure><p id="4773" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">粉色盒子→每个RNN都有时间戳的概念，在这种情况下，因为每个时间戳都有很多事情要做。我决定叫他们时间盒LOL。</p><p id="fabe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">红框→执行顺序。请注意，在更新重量之前，我们不必完全等待前馈过程完成，如方框2、4、5和7所示。</p><p id="eec4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">橙色星形→每个时间戳的真实梯度，我们需要这个值来更新每个时间戳的Oracle(绿色菱形，您在第一张图片中看到的)。此外，获得这个值的数学公式非常长，所以我将在下一节中以代码实现的形式展示它们。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="5ad7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">时间盒1 /2的真实渐变—橙色星形A / B </strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jz"><img src="../Images/739ede525c4a918e41f05ce232276ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X_J7AqYc-SGpc6p0dIMFpg.png"/></div></div></figure><p id="5695" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">红框→时间框2的前馈过程</p><p id="d3c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">蓝框→使用合成梯度2 (w_sg_2)在时间框2对Wrec和Wx进行反向传播。</p><p id="d0f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">橙色框→用从时间框2获得的真实梯度更新合成梯度1(w_sg_1)</p><p id="1d8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且为了更新我们的合成梯度2(w_sg_2)，我们使用完全相同的概念，但是使用完全连接的层。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es ka"><img src="../Images/650ff862860859af30812fb96a30e528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0IaLmRkb2MS6DenWQlo1XQ.png"/></div></div></figure><p id="9192" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，非常相似的过程，但梯度从时间盒3。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="0f78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">培训及结果</strong></p><div class="jn jo jp jq fd ab cb"><figure class="kb jr kc kd ke kf kg paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/2888759666f0ae9d33422cd676e05388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*3Umr_laoBBeBjDoOe7KiwA.png"/></div></figure><figure class="kb jr kh kd ke kf kg paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/da12cf6d506be0450d3928f568d1eada.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*qYzSs_tlYvVdDUYCOg2z9w.png"/></div></figure></div><p id="58bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我做了多次训练和跑步，因为训练很不稳定。即使使用相同的np.random.seed()值，有时网络也会很好地收敛，如左图所示，或者飞离，如右图所示。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es ki"><img src="../Images/c0ed6d1c0cf136d02c51bcb13363d66d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oc2CYzVOyN6GBylRc0x12g.png"/></div></div></figure><p id="5f4e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个非常有趣的例子是成本飙升，然后有所下降。然而，总的来说，该模型与20个图像的分类测试集很好。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es kj"><img src="../Images/671e309853a09bf519b70f5a9e183b42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OiFQ3XJrIiTnN6ZXZbygg.png"/></div></div></figure><p id="330e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过几次尝试，100%的准确度也是可能的。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="f955" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">交互代码</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es kk"><img src="../Images/c616d1cecb70f14295e67d99b6a2b5d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Jd6yQdVgefkGQkHxKs3NQ.png"/></div></div></figure><p id="4b1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kl">我搬到了谷歌Colab寻找交互代码！所以你需要一个谷歌帐户来查看代码，你也不能在谷歌实验室运行只读脚本，所以在你的操场上做一个副本。最后，我永远不会请求允许访问你在Google Drive上的文件，仅供参考。编码快乐！</em></p><p id="0454" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要获取代码，请点击此处。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="7712" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">最后的话</strong></p><p id="9e2b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我一直惊讶于这样一个事实，即我们仍然可以不遵循严格的反向传播规则来训练神经网络。我还发表了一篇关于用<a class="ae jd" rel="noopener" href="/@SeoJaeDuk/only-numpy-noise-training-training-a-neural-network-without-back-propagation-with-interactive-ad775f04cad6">随机噪声分布</a>训练神经网络的文章。</p><p id="234b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果发现任何错误，请发电子邮件到jae.duk.seo@gmail.com找我。</p><p id="ccc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同时，在我的twitter <a class="ae jd" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>关注我，并访问<a class="ae jd" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或我的<a class="ae jd" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解更多内容。如果你感兴趣的话，我还做了解耦神经网络的比较。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="2103" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">参考</p><ol class=""><li id="e8a0" class="km kn hi ih b ii ij im in iq ko iu kp iy kq jc kr ks kt ku bi translated">贾德伯格，m .，Czarnecki，W. M .，奥辛德罗，s .，维尼亚尔斯，o .，格雷夫斯，a .，&amp; Kavukcuoglu，K. (2016)。使用合成梯度的去耦神经接口。<em class="kl"> arXiv预印本arXiv:1608.05343 </em>。</li><li id="0f1e" class="km kn hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated">没有反向传播的深度学习。(未注明)。检索于2018年2月3日，来自<a class="ae jd" href="https://iamtrask.github.io/2017/03/21/synthetic-gradients/" rel="noopener ugc nofollow" target="_blank">https://iamtrask.github.io/2017/03/21/synthetic-gradients/</a></li><li id="f20f" class="km kn hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated">Seo，J. D. (2017年12月24日)。Only Numpy:在合成梯度中导出前馈和反向传播(解耦神经…2018年2月03日检索，来自<a class="ae jd" rel="noopener" href="/swlh/only-numpy-deriving-forward-feed-and-back-propagation-in-synthetic-gradient-decoupled-neural-ca4c99666bbf">https://medium . com/swlh/only-Numpy-derivating-Forward-feed-and-Back-Propagation-in-Synthetic-Gradient-Decoupled-Neural-ca4c 99666 bbf</a></li><li id="4abb" class="km kn hi ih b ii kv im kw iq kx iu ky iy kz jc kr ks kt ku bi translated">Seo，J. D. (2018年02月01日)。only Numpy:Noise Training-Training a Neural-Network-with Back Propagation with Interactive…2018 . 02 . 03检索自<a class="ae jd" rel="noopener" href="/@SeoJaeDuk/only-numpy-noise-training-training-a-neural-network-without-back-propagation-with-interactive-ad775f04cad6">https://medium . com/@ SeoJaeDuk/only-Numpy-Noise-Training-Training-a-Neural-Network-with-Interactive-ad 775 f 04 cad6</a></li></ol><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es la"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="lb lc hi bd ld le lf lg lh li lj lk ll iq lm ln lo iu lp lq lr iy ls lt lu lv bi translated">这篇文章发表在<a class="ae jd" href="https://medium.com/swlh" rel="noopener">《创业</a>》上，这是Medium最大的创业刊物，有293，189+人关注。</h2><h2 id="7945" class="lb lc hi bd ld le lf lg lh li lj lk ll iq lm ln lo iu lp lq lr iy ls lt lu lv bi translated">在这里订阅接收<a class="ae jd" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es la"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>