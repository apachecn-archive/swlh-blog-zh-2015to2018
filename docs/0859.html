<html>
<head>
<title>Top things to keep in mind while deploying a Rails app to production?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在将Rails应用程序部署到生产环境时，需要记住的首要事项是什么？</h1>
<blockquote>原文：<a href="https://medium.com/swlh/top-things-to-keep-in-mind-while-deploying-a-rails-app-to-production-4c1eec3912c2?source=collection_archive---------0-----------------------#2017-07-14">https://medium.com/swlh/top-things-to-keep-in-mind-while-deploying-a-rails-app-to-production-4c1eec3912c2?source=collection_archive---------0-----------------------#2017-07-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/40900fa50179dccb1fae2ea5056be5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0N9LtK8RzNSUSFmGvmeEPw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Top things to keep in mind while deploying a Rails app to production?</figcaption></figure><p id="99ee" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">无论您的开发人员选择哪个平台进行部署，除了您将为所选环境遵循的步骤之外，还有一些通用的清单需要遵循。从一开始，你就必须做出以下选择:</p><ul class=""><li id="7c1c" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated"><strong class="iw kb">在哪里部署和选择web服务器</strong>:您必须根据成本考虑、补丁和升级的健全性检查来做出决定。对于服务器，你会发现普遍的选择是乘客或彪马。必须考虑RAM的使用情况，可以使用定制安装的软件进行监控。对指标、自动警报、错误测量和详细诊断进行检查，以识别源代码中的问题。请记住，您选择使用的Rail版本应该保证长期支持。</li><li id="c598" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated"><strong class="iw kb">选择合适的数据库和内容交付网络</strong>:你对数据库的选择是一种权衡，最终可能会增加RAM的大小。Rails函数允许以简单的方式批量获取小器械包进行处理，并且可以随时投入使用。您可以通过使用内容交付网络来提高数量。检查图像上传，因为像Heroku这样的特定环境可以施加超时限制。出于安全考虑，有必要取消对多余员工的访问权。此外，考虑到故障不可避免，一旦Rails上线，一定要指定一名有能力的员工负责，并配备适当的钥匙。</li></ul><h2 id="f881" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">基本步骤:</h2><ul class=""><li id="e3a5" class="js jt hi iw b ix lc jb ld jf le jj lf jn lg jr jx jy jz ka bi translated">确保对可维护性、可读性、快速开发和重复进行检查。</li><li id="a627" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">名称服务器需要更改，主交换机记录需要更正，以便重定向收到的邮件。</li><li id="06bf" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">应提供适当的数据库索引。虽然它可以降低插入查询的速度，但是它可以提高读取查询的性能。</li><li id="3476" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">需要识别和检查用户。</li></ul><h2 id="2bc6" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">安全性和备份:</h2><ul class=""><li id="5f48" class="js jt hi iw b ix lc jb ld jf le jj lf jn lg jr jx jy jz ka bi translated">您必须为生产数据的定期备份建立一个计划的备份机制。备份应该包括代码、数据和用户上传的数据。</li><li id="96b7" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">明文不应该是存储用户密码的形式。用户提交的信息不应局限于数据库查询。</li><li id="70fb" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">在控制器中设置防止伪造的保护措施。真实性标记必须出现在所有提交的表单上。</li><li id="a592" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">防止用户帐户ID被覆盖。</li><li id="0623" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">应维护用于灾难管理的有限回滚版本，而不是跨遗留系统。</li><li id="7de7" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">验证用户提交文件的内容类型和扩展名，并保护上传目录不运行脚本</li><li id="1ecb" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">如果应用程序发生了不好的情况，将建立一个通知机制。可以使用托管服务或通知程序插件选项。</li><li id="2c9a" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">机密数据，如信用卡信息、个人数据等。应该防止泄漏。此类机密信息不应写入日志文件。</li></ul><h2 id="8420" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">操作检查:</h2><ul class=""><li id="8a31" class="js jt hi iw b ix lc jb ld jf le jj lf jn lg jr jx jy jz ka bi translated">识别慢速查询日志以进行优化。</li><li id="1a8a" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">该应用程序应该允许定期重复的工作，如邮件和通讯。这可以通过CRON或类似的程序来完成</li><li id="3c07" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">将进行检查以确保所有流程，如Mongrel、Apache等。，应用程序所需的。这可以通过标准的监控工具来完成。</li><li id="9c16" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">随着时间的推移，日志文件的大小会不断增加，较大的文件需要更多的时间来打开和下载。为应用程序建立一个日志循环设置。</li><li id="bb52" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">应该包括一个计划任务来消除过时的会话。</li><li id="ad1b" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">设置资产主机以减少加载时间。</li><li id="1236" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">控制器应该包含请求处理和响应相关的逻辑。</li><li id="23e6" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">应用程序需要从一开始就国际化。这最好与开发一起完成。为其他语言定制应该很容易。</li><li id="47d7" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">确保版本控制系统检查已经完成</li><li id="1f30" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">Rails框架附带了内置的代码重载机制。每当你引用一个不存在的类时，如果你安装了一个钩子，相同的钩子代码将试图定位并加载与该类相关的文件。你需要检查这个。</li></ul><h1 id="2b9e" class="lh ki hi bd kj li lj lk kn ll lm ln kr lo lp lq ku lr ls lt kx lu lv lw la lx bi translated">关于所选环境的具体注意事项将包括:</h1><h2 id="32cf" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">Heroku:</h2><p id="20e2" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf ly jh ji jj lz jl jm jn ma jp jq jr hb bi translated">Heroku将使你的开发者更容易配置。检查至少应该包括包安装、加密和管理机密、初始化、监控、Nginx配置、SSH密钥、SSL配置、Capistrano配置、日志记录和安全性。</p><h2 id="ede1" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">乘客:</h2><p id="a227" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf ly jh ji jj lz jl jm jn ma jp jq jr hb bi translated">客运易于使用，将使您的部署过程简单和可伸缩性。启动服务器、安装Ruby runtime、安装passenger、设置生产服务器、创建UNIX用户帐户和设置权限、部署应用程序、确保更新和与web服务器的集成是最基本的。乘客可以产生多个应用程序。在乘客身上展开时，一些额外的考虑事项是:</p><ul class=""><li id="8a40" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">性能:运行的进程越多，CPU内核的利用率就越高，直到达到硬件极限。你会发现Standalone和Nginx比Apache稍快。</li><li id="c53e" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">I/O并发性:运行的进程越多，可用的I/O并发性就越大。这使得你的应用程序性能更好。</li><li id="2b4c" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">稳定性:See Passenger重新启动崩溃的进程，而其他进程不受影响，并且可以接管，以防您的应用程序进程崩溃。</li><li id="9730" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">控制问题:许多问题，比如卡住或内存泄漏，都可以通过重启出现问题的进程来控制。</li><li id="e40a" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">对于可用性:独立在开发过程中更容易，但Nginx和Apache在生产过程中更容易。</li><li id="d21e" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">多租户:Nginx和Apache集成模式可以同时托管多个应用。</li><li id="4606" class="js jt hi iw b ix kc jb kd jf ke jj kf jn kg jr jx jy jz ka bi translated">灵活性和控制:如果您需要深入控制系统的每个方面，或者如果您的生产集群具有高级架构，那么独立将是您在生产期间的最佳选择。</li></ul><h2 id="cc2a" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">Ubuntu:</h2><p id="a09e" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf ly jh ji jj lz jl jm jn ma jp jq jr hb bi translated">你必须创建一个虚拟私人服务器，选择一个图像，选择大小，选择地区，然后继续安装Ruby，Nginx，MySQL和PostgreSQL数据库设置，Capistrano设置，添加Nginx主机并连接数据库。</p><h2 id="97aa" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">Capistrano上的自动化:</h2><p id="86f0" class="pw-post-body-paragraph iu iv hi iw b ix lc iz ja jb ld jd je jf ly jh ji jj lz jl jm jn ma jp jq jr hb bi translated">Capistrano是一个应用程序发布自动化工具。当您发布web应用程序的新版本时，您将不得不执行一系列操作，比如运行一个命令来安装您的gem包，将您的应用程序代码上传到您的服务器，重新启动进程，等等。Capistrano让您的开发人员自动化所有这些操作。</p><blockquote class="mb"><p id="6ab1" class="mc md hi hj me mf mg mh mi mj mk jr dx translated"><em class="ml">服务器Capistrano，不会为您提供HTTP事务处理。这意味着它不会取代web服务器或应用服务器。相反，你必须和他们一起使用Capistrano。例如，Capistrano脚本附带了在新的应用程序版本发布后重启应用服务器的指令。</em></p></blockquote></div><div class="ab cl mm mn gp mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="hb hc hd he hf"><p id="90a2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><em class="mt">最初发表于CognitiveClouds的产品洞察博客:Top </em> <a class="ae mu" href="https://www.cognitiveclouds.com/custom-software-development-services/ruby-on-rails-development-company" rel="noopener ugc nofollow" target="_blank"> <strong class="iw kb"> <em class="mt"> Ruby on Rails开发公司</em> </strong> </a></p><figure class="mw mx my mz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">这篇文章发表在<a class="ae mu" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有299，352+人关注。</h2><h2 id="7945" class="kh ki hi bd kj kk kl km kn ko kp kq kr jf ks kt ku jj kv kw kx jn ky kz la lb bi translated">在此订阅接收<a class="ae mu" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="mw mx my mz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>