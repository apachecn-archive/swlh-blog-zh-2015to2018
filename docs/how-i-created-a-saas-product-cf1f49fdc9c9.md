# 我如何为网络开发者创造 SaaS 产品

> 原文：<https://medium.com/swlh/how-i-created-a-saas-product-cf1f49fdc9c9>

![](img/3e6394c57bc2058b28d8a381b8d85e55.png)

这篇文章分享了我如何处理自己的渴望来改进测试工作流程的旅程。

它讨论了我在工作中遇到的问题，以及我是如何试图解决这些问题的。我开始尝试现有的第三方解决方案，然后构建了一个开源解决方案来更好地满足我自己的需求。最终，它在 team works 中的使用促使我开发了一个 SaaS 版本。

# 有什么问题？

我的大多数项目都是全栈式的，包括前端和后端。前端通常使用 JS MVC 框架，如 Angular.js 或 React.js，后端使用 Node.js 栈。前端使用 REST API architect 连接到后端。

对于 web SPA(单页应用程序)应用程序，它们通常在一个页面中包含许多状态。要重现其中一种状态，可能需要在页面上按一定顺序进行许多操作。

在大多数情况下，前端是用户和后端之间的中心交互点。后端的测试可能也需要通过前端，以验证后端的变化与前端兼容。

![](img/4baf50951d7f30ff011ad96ea71bbbf0.png)

如果目标状态的深度很深，我需要在浏览器中重复一定数量的手动行为来进行验证。做这种重复的手工测试很费时间。它扼杀了我作为开发人员的生产力和创造力。

![](img/1532bea1eaba0701eedead5fa515292c.png)

Testing workflow

这听起来熟悉吗？

# 早期尝试

我喜欢单元测试，并为后端代码创建单元测试，但从不为前端代码创建单元测试。

所以我尝试在前端使用单元测试的概念。当时，我使用 Angular.js 作为大多数项目的前端框架。我挑选并尝试了有角度的 e2e 测试堆栈，[量角器](https://github.com/angular/protractor) + [摩卡](https://mochajs.org/)。它是在 angular 框架上进行自动化测试的最流行的堆栈。

经过一些实验后，我意识到这种测试方式引入了其他问题。它需要对测试代码投入大量的精力。测试代码很难维护，也不能减轻手工测试的痛苦。

为了用这个框架重复运行测试，它需要为后端 API 请求创建许多模拟。它假设前端开发人员非常了解后端，以及它如何与前端一起工作。通常，测试中会添加一些神奇的代码来通过测试。这些神奇的代码是有问题的，很难长期维护。

因此，使用这个测试框架，需要有经验的开发人员以可管理的方式创建测试。否则，测试将变得太脆弱而无法维护，并且对开发过程的贡献是开销大于收益。实际上，前端开发人员可能来自不同的背景。他们可以是初级或高级开发人员，有不同的编码风格。

另一个问题是测试只是验证逻辑的一部分。它没有使用实际的浏览器行为进行测试。通过所有的测试并不能给我足够的自信。我仍然需要运行手动测试，看看它在实际浏览器中是否正常工作。

![](img/7c23aa9725809b93884337a87200f4e3.png)

Unit tests passed…

这让我怀疑是否值得用这样的框架编写代码来测试 UI 代码。

# 再试

![](img/b3c895c1ae0a98c35c4f39310591cb32.png)

我更赞同《改进测试的五十个快速想法》一书所强调的:测试应该集中在探索用户的能力上。

我开始寻找一种更简单的方法，用最少的开发过程开销来做前端测试。

有！另一种测试方法叫做视觉回归测试。这就像将编辑器中的[所见即所得](https://en.wikipedia.org/wiki/WYSIWYG)概念应用到测试中。

![](img/3f2928cbd60b252bbd78aa43fbc9925f.png)

Let the bot spot the embarrassing stuffs quickly

> *基本上，这个想法是比较新旧用户界面截图。然后，它会自动生成一个图像，突出显示截图之间的差异。*

当检测到差异时，开发人员可以检查差异图像，看它是否如预期的那样。为了接受差异，开发人员只需要重新调整截图，而不需要更改测试代码。这大大加快了测试过程。我们的大脑更善于审查图像而不是代码，这符合人类的本性。

原来已经有几个开源库来做这项工作了。我回顾了其中的一些，挑选了一个叫做 [BackstopJS](https://github.com/garris/BackstopJS) 的，看起来很容易用来做 UI 测试。

# 为我自己的痒造一个新的

BackstopJS 在可视化回归测试如何帮助前端测试方面给了我很多启发。我试图用它来测试 SPA(单页应用程序)应用程序。在场景测试结束时，需要一个最终的屏幕截图来进行可视化回归测试。但是，它也需要编写自由式脚本来更新页面的状态。这引入了在**早期试验**部分中讨论的相同维护问题。自由式脚本最终很可能会变得难以维护，尤其是当不止一个开发人员接触测试脚本的时候。

![](img/01ba78b483f63bb145360beaa20b89dd.png)

So messed that people dump it eventually

此外，我需要它是灵活的截图，并在任何需要的时候在一个场景中的任何测试步骤进行比较，而不仅仅是在最后一步。

这些实验让我想知道:

> 为什么不把常见的浏览器行为，比如点击/输入/选择/截图等格式化成标准的 JSON 格式呢？

从长远来看，阅读和更新 JSON 代码比使用自由式测试脚本更容易。

所以我创建了一个名为**vbot**的[开源库，从那以后我一直用它来测试我的前端项目。](https://github.com/katat/vbot)

## 我的测试过程是如何改进的？

1.  测试中没有魔法代码。
2.  独立于技术栈，只要 app 可以在 web 浏览器中使用，vbot 就可以用于测试。
3.  使用以所见即所得方式定义的 JSON，更容易引用实际的浏览器行为。
4.  审查并批准新的屏幕截图，而不是更新测试代码以通过测试。

![](img/f8f3f821f62e669927ecddcb26228af8.png)

baseline/differences/new

![](img/263d2ee81df00346838c09941a735d6a.png)

automate the tests and watch the playback in action

# 为团队工作添加成分

因为我也是这个工具的使用者，所以我很容易得到第一手的反馈。我用得越多，我就有越多的想法来改进和发展它。

当在团队中使用 vbot 时，基线截图需要在某处共享，以便其他团队成员可以根据基线运行测试。

Git 存储库是存储基线图像的初始位置。但是这些图像文件变得太大，暂时无法存储在上面。此外，由于不同的开发环境设置，从不同的开发环境为同一 UI 页面生成的屏幕截图会略有不同。即使是很小的差异，也可能产生假阴性结果。

如果测试结果可以存储在服务器上的某个地方，并且只需通过浏览器就可以查看，那就简单多了。因此，通过共享测试结果来与团队沟通会更有效率。

![](img/e7d2bd1ea795b725b2d0655359bf6a7b.png)

想象一个场景，其中有一个失败的测试存储在服务器上，所有的浏览器行为都被记录下来，还有截图。为了通知其他人这个问题，它只需要共享一个 URL 链接，其他人可以在失败的测试中打开来查看。更方便的是，他们可以下载剧本来运行测试，以便在试图解决问题时在本地机器上快速重现错误。

# 加油 SaaS

将 vbot 作为 web 上的服务有多种好处。它不仅为团队成员提供了一个分享他们测试的地方，也是对开源版本的补充:

*   它使用户能够通过 UI 创建行动手册，对于新用户来说更容易上手。
*   用户只需要一个网络浏览器就可以对公共网站进行自动测试。
*   在 vbot.io 上创建的行动手册可以通过 vbot CLI 工具下载，并通过一个命令行在本地运行。更容易调试问题或重现错误。
*   测试在服务器上相同的容器化环境下运行，减少了由于开发环境设置的多样性而导致的相同测试中出现差异的几率。
*   剧本以及测试结果可以与其他用户共享，更便于团队就问题进行交流。

测试工作流程中的这些潜在改进给了我足够的动力来围绕它构建一个 [SaaS 版本](https://vbot.io/)。

![](img/d063de1a152ffea8250af39d474ba663.png)

vbot.io online test demo

# 最后的话

旅程始于 2016 年，GitHub 上的[第一版 vbot 于 2017 年初发布。作为一个兼职项目，我花了大部分业余时间做迭代，使它更好更容易使用。花了近 6 个月的时间来建立 SaaS 版本。](https://github.com/katat/vbot)

我没想到我会在测试领域创建一个开源库，也没想到会围绕它创建一个 SaaS 产品。这是一个从零开始的实验过程，其间有许多研究和试错实践。

在这个过程中，我确实有一些来自内心的疑问，想知道“**值得吗？**”。*这整个旅程的主要驱动力是，它是一个为我自己的痒痒而打造的工具*。我很高兴能走到这一步。

如果您需要一种简单/高效的方法来自动化测试您的 web 应用程序并改进您的开发工作流程，您可能希望尝试一下 [**vbot.io**](https://vbot.io) 。有几个改进和特性计划使测试工作流程对开发人员来说更加容易。保持调谐！

这个帖子分享了一点我在 UI 测试边项目的痕迹。希望它能对任何想要构建自己的项目的人有所帮助。我将很高兴与任何想法互动，请随时评论。

*原载于 2018 年 1 月 1 日*[*katat . github . io*](http://katat.me/2018/01/01/vbot-saas-journey/)*。*

![](img/731acf26f5d44fdc58d99a6388fe935d.png)

## 这篇文章发表在 [The Startup](https://medium.com/swlh) 上，这是 Medium 最大的创业刊物，拥有 277，994+读者。

## 在这里订阅接收[我们的头条新闻](http://growthsupply.com/the-startup-newsletter/)。

![](img/731acf26f5d44fdc58d99a6388fe935d.png)