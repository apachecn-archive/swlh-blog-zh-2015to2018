<html>
<head>
<title>Playing with word vectors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">玩弄词向量</h1>
<blockquote>原文：<a href="https://medium.com/swlh/playing-with-word-vectors-308ab2faa519?source=collection_archive---------0-----------------------#2018-01-24">https://medium.com/swlh/playing-with-word-vectors-308ab2faa519?source=collection_archive---------0-----------------------#2018-01-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0a6e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在过去的几年中，人工智能领域发展如此之快，关于它的文章也如此之多，你可能已经听说了自然语言处理中一些令人印象深刻的结果。</p><p id="7847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，通过阅读维基百科，程序可以学习完成类比:<code class="du jd je jf jg b">man is to king is like woman is to ___?</code> (queen)。</p><p id="747e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我写了一个简单的程序来亲眼看看。我很好奇:<strong class="ih jh"> <em class="ji">它能回答多难的问题？</em> </strong></p><p id="4d3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇博客是对这个话题的一个非常简单的介绍。我没有训练机器学习模型。相反，我下载了使用<a class="ae jj" href="https://fasttext.cc/docs/en/english-vectors.html" rel="noopener ugc nofollow" target="_blank"> fastText </a>库创建的预训练英语单词向量。</p><h2 id="4205" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">先看数据</h2><p id="6aad" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">fastText通过阅读维基百科学到了什么？让我们打开2GB文件看一看:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="e727" class="jk jl hi jg b fi ks kt l ku kv">good -0.1242 -0.0674 -0.1430 -0.0005 -0.0345 ...<br/>day 0.0320 0.0381 -0.0299 -0.0745 -0.0624 ...<br/>three 0.0304 0.0070 -0.0708 0.0689 -0.0005 ...<br/>know -0.0370 -0.0138 0.0392 -0.0395 -0.1591 ...<br/>...</span></pre><p id="ee00" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了，这种格式应该很容易使用。每行包含一个单词，在300维空间中表示为一个向量。如果这是在2D，我们可以这样想象:</p><figure class="kk kl km kn fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kw"><img src="../Images/b07804a2fe2a68848916b98fa63b8c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mWQtzgXAFTsLg6NAjK6xDg.png"/></div></div></figure><p id="72ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">唯一不同的是每个字不是2个坐标，而是300个。</p><p id="c16a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输入文件中的单词方便地按频率排序。对于我的实验来说，使用最常见的100k个英语单词就足够了，所以我将前100k行复制到一个单独的文件中。</p><h2 id="a708" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">使用Python 3</h2><p id="db46" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">为了让我的第一个项目简单，我决定使用没有额外依赖的普通Python 3。我还使用了<a class="ae jj" href="http://mypy-lang.org/" rel="noopener ugc nofollow" target="_blank"> Mypy </a>，一个Python的静态类型检查器。</p><p id="9dfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将定义一个类来表示每个单词:</p><figure class="kk kl km kn fd kx"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="50f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，让我们将数据载入内存:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="a566" class="jk jl hi jg b fi ks kt l ku kv">words = load_words('data/words.vec')</span></pre><p id="2954" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经将文件解析成了一个<code class="du jd je jf jg b">List[Word]</code>。这部分很简单，所以我们将把细节留到文章的最后，直接进入有趣的部分。</p><h2 id="1ca6" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">余弦相似性</h2><p id="b585" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">现在我们在内存中有了向量，我们可以回答关于它们的各种问题。我的第一个问题是:</p><blockquote class="lg lh li"><p id="9f01" class="if ig ji ih b ii ij ik il im in io ip lj ir is it lk iv iw ix ll iz ja jb jc hb bi translated">向量空间中哪个词最接近给定的词？</p></blockquote><p id="c6e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何计算两个单词向量a，b之间的距离？你可能会说“欧几里德距离”，但是<strong class="ih jh"> <em class="ji">余弦相似度</em> </strong>更适合我们的用例。这个想法是矢量的绝对长度无关紧要，有趣的是两个矢量 之间的<strong class="ih jh"> <em class="ji">角度。</em></strong></p><p id="c59f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">来自高中(或维基百科):</p><figure class="kk kl km kn fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lm"><img src="../Images/424fd166523aa88fcf69d5cb63bccc05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Acs3Kbrrrb4d3fqMlGhMcQ.png"/></div></div></figure><p id="db7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Python中:</p><figure class="kk kl km kn fd kx"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="27aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以找到与给定向量相似的词:</p><figure class="kk kl km kn fd kx"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="a234" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们只需要一些简单的实用函数来打印相关的单词:</p><figure class="kk kl km kn fd kx"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="69d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候尝试一下了:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="93bb" class="jk jl hi jg b fi ks kt l ku kv">&gt;&gt;&gt; print_related(words, 'spain')<br/>britain, england, france, europe, germany, spanish, italy</span><span id="048a" class="jk jl hi jg b fi ln kt l ku kv">&gt;&gt;&gt; print_related(words, 'called')<br/>termed, dubbed, named, referred, nicknamed, titled, described</span><span id="c5a8" class="jk jl hi jg b fi ln kt l ku kv">&gt;&gt;&gt; print_related(words, 'although')<br/>though, however, but, whereas, while, since, Nevertheless</span><span id="0a5c" class="jk jl hi jg b fi ln kt l ku kv">&gt;&gt;&gt; print_related(words, 'arms')<br/>legs, arm, weapons, coat, coats, armaments, hands</span><span id="8592" class="jk jl hi jg b fi ln kt l ku kv">&gt;&gt;&gt; print_related(words, 'roots')<br/>root, origins, stems, beginnings, rooted, grass, traditions</span></pre><p id="42fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相当令人印象深刻！看起来具有高余弦相似性的单词彼此相关，要么是句法上的(“根”，“有根的”)要么是语义上的(“根”和“草”，“胳膊”和“腿”)。</p><h2 id="d228" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">完成句子:巴黎对于法国就像罗马对于___</h2><p id="5c91" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">让我们试试更难的。给定两个像“巴黎”和“法国”这样有语义关系的词(巴黎是法国的首都)，还有第三个词“罗马”，我们能推断出“意大利”吗？</p><p id="a6e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">事实证明，我们可以简单地通过加减向量来做到这一点！这是因为这些单词的向量在空间中具有特定的关系:</p><figure class="kk kl km kn fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es lo"><img src="../Images/796a452484bfe826aea92697bae583bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EOVxNmHkrsPQ7Q44N0OiQg.png"/></div></div><figcaption class="lp lq et er es lr ls bd b be z dx">It turns out the red vectors are very similar! We can imagine they represent the relationship “capital”.</figcaption></figure><p id="07ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">令人惊讶的是:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="ffa8" class="jk jl hi jg b fi ks kt l ku kv">vector(“France”) - vector("Paris") = answer_vector - vector("Rome")</span></pre><p id="7a03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="a6b3" class="jk jl hi jg b fi ks kt l ku kv">vector(“France”) - vector("Paris") + vector("Rome") = answer_vector</span></pre><p id="3a42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将寻找接近<code class="du jd je jf jg b">answer_vector</code>的单词。<code class="du jd je jf jg b">answer_vector</code>不会与“意大利”完全匹配，但应该很接近。</p><p id="792d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来实现它:</p><figure class="kk kl km kn fd kx"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="d870" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们问一些问题:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="17a4" class="jk jl hi jg b fi ks kt l ku kv">&gt;&gt;&gt; print_analogy('Paris', 'France', 'Rome', words)<br/><strong class="jg jh">Paris-France is like Rome-Italy</strong></span><span id="49b0" class="jk jl hi jg b fi ln kt l ku kv">&gt;&gt;&gt; print_analogy('man', 'king', 'woman', words)<br/><strong class="jg jh">man-king is like woman-queen</strong></span><span id="ec3d" class="jk jl hi jg b fi ln kt l ku kv">&gt;&gt;&gt; print_analogy('walk', 'walked' , 'go', words)<br/><strong class="jg jh">walk-walked is like go-went</strong></span><span id="e37d" class="jk jl hi jg b fi ln kt l ku kv">&gt;&gt;&gt; print_analogy('quick', 'quickest' , 'far', words)<br/><strong class="jg jh">quick-quickest is like far-furthest</strong></span></pre><p id="fa59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jh">成功了！</strong>🎉通过阅读维基百科，fastText了解了一些关于大写，性别，不规则动词和形容词(！)再来试几个:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="0e25" class="jk jl hi jg b fi ks kt l ku kv">English-Jaguar is like German-BMW      // Expensive cars<br/>English-Vauxhall is like German-Opel   // Cheaper cars</span><span id="8297" class="jk jl hi jg b fi ln kt l ku kv">German-BMW is like American-Lexus      // Expensive cars<br/>German-Opel is like American-Chrysler  // Cheaper cars</span></pre><p id="91af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="f5c7" class="jk jl hi jg b fi ks kt l ku kv">&gt;&gt;&gt; print_analogy('dog', 'mammal', 'eagle', words)<br/>dog-mammal is like eagle-bird</span></pre><p id="e894" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jh">这种模式并不总是正确的</strong></p><p id="f999" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你将如何完成下列类比？<br/> 1。寿司饭就像披萨-_ _ _ _ _ _<br/>2。寿司饭就像牛排-_ _ _ _ _ _<br/>3。衬衫-衣服就像电话-_ _ _ _ _ _<br/>4。衫衣如碗-_ _ _ _ _ _<br/>5。读书就像电视-___</p><p id="5c84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">寿司是由米饭和其他配料做成的，比萨饼是由面团/意大利腊肠/奶酪等做成的。牛排是由肉制成的。衬衫是一种衣服，电话是一种电子产品，碗是一种盘子。我们看书，看电视。</p><p id="a810" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看答案:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="b3d3" class="jk jl hi jg b fi ks kt l ku kv">sushi-rice is like pizza-wheat      // Makes sense<br/>sushi-rice is like steak-chicken<br/>shirt-clothing is like bowl-food<br/>shirt-clothing is like phone-mobile<br/>book-reading is like TV-television</span></pre><p id="a79f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="244d" class="jk jl hi jg b fi ks kt l ku kv">&gt;&gt;&gt; print_analogy('do', 'done' , 'go', words)<br/>do-done is like go-undertaken</span></pre><p id="9970" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所看到的，fastText并没有把每一个类比都做对。结果令人印象深刻，但当他们错了，他们似乎很遥远。</p><p id="81f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">也许如果我们看看建议列表而不是第一条，会有一些更好的答案？</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="1cbd" class="jk jl hi jg b fi ks kt l ku kv">sushi-rice is like steak-<br/>[chicken (0.58), <strong class="jg jh">beef (</strong>0.56), potatoes (0.56), corn (0.55)]</span><span id="d171" class="jk jl hi jg b fi ln kt l ku kv">book-reading is like TV-<br/>[television (0.68), <strong class="jg jh">watching </strong>(0.64), listening (0.57), viewing (0.57)]</span><span id="6667" class="jk jl hi jg b fi ln kt l ku kv">shirt-clothing is like bowl-[food, cereal, rice, porridge]</span><span id="b77d" class="jk jl hi jg b fi ln kt l ku kv">shirt-clothing is like phone-[mobile, cellular]</span></pre><p id="2182" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在两种情况下，第二个建议真的很好。然而，看起来“衬衫”和“服装”之间的关系仍然是一个谜。</p><h2 id="85fa" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">结论</h2><p id="80d5" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">当我第一次在笔记本电脑上看到这些结果时，我完全惊呆了。这个程序由几行Python代码组成，让你觉得它很聪明，而且实际上<em class="ji">理解</em>你在问什么。</p><p id="2574" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一次我尝试了几个难题，我意识到这个程序可能会“犯很大的错误”，这是人类永远不会做到的。这可能会让你觉得这个模型并不聪明。</p><p id="d72a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然而，请考虑这一点:向量是在英语文本上训练的，但与人不同的是，学习算法没有任何英语知识。<em class="ji">在一个</em> <strong class="ih jh"> <em class="ji">几个小时</em> </strong>的阅读维基百科中，它相当好地学会了英语语法，以及现实世界概念之间的许多语义关系。给定足够的文本，它可以对德语、泰语、中文或任何其他语言做同样的事情。</p><p id="a7c0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个孩子需要多长时间才能发展出足够的逻辑思维，直到能够回答像这篇帖子中的问题？成人学外语怎么样？用两三种语言做这件事怎么样？人类需要几年时间，而Word2vec或fastText只需要几个小时。人们的学习方式与这些算法非常不同。人们可以从更少的数据中更好地学习概念，但这需要花费我们更长的时间。</p><p id="2c71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章的所有代码都可以在<a class="ae jj" href="https://github.com/mkonicek/nlp" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。你只需要Python 3和<a class="ae jj" href="https://fasttext.cc/docs/en/english-vectors.html" rel="noopener ugc nofollow" target="_blank">预先训练好的向量</a>来运行代码，自己寻找单词之间有趣的关系。</p><p id="a903" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这个，请在推特上关注我。</p><h1 id="3541" class="lt jl hi bd jm lu lv lw jq lx ly lz ju ma mb mc jx md me mf ka mg mh mi kd mj bi translated">附录</h1><p id="a41b" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">我想让这篇文章尽可能简短，同时涵盖最重要的基础知识和有趣的结果。请继续阅读，了解更多详情。</p><h2 id="b384" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">一个小黑客</h2><p id="db2c" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">当我第一次实现该算法时，我得到了错误的结果，例如:</p><pre class="kk kl km kn fd ko jg kp kq aw kr bi"><span id="0a71" class="jk jl hi jg b fi ks kt l ku kv">man-king is like woman-king</span></pre><p id="dc58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是因为计算为<code class="du jd je jf jg b">answer = vector(king)-vector(man)+vector(woman)</code>的答案向量非常接近单词“king”。换句话说，减去“男人”的向量并加上“女人”的向量对“国王”的原始向量没有什么影响，可能是因为那些“男人”和“女人”本身是相关的。</p><p id="0188" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上，我得到的几乎所有答案都只是简单地重复了一个输入的单词。我添加了一个hack来跳过建议答案列表中的这些冗余单词，并开始获得如上所示的有趣答案。这种黑客行为在代码中被称为<code class="du jd je jf jg b">is_redundant</code>。</p><p id="3989" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更新:fastText的作者托马斯·米科洛夫<a class="ae jj" href="https://www.facebook.com/groups/1174547215919768/permalink/1846673885373761/" rel="noopener ugc nofollow" target="_blank">在脸书</a>上回复说，我所做的实际上是一个众所周知的把戏，它是正确的。</p><h2 id="2770" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">载体是如何产生的？</h2><p id="c0ef" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">我只写了几行代码就得到这些惊人的结果。这是因为所有的魔法都存在于向量中，这些向量是使用fastText从维基百科和其他来源的千兆字节的英语文本中训练出来的。还有其他类似于fastText的库，比如Word2vec和GloVe。那些图书馆是如何运作的？对于另一个帖子来说，这是一个很大的<a class="ae jj" href="https://arxiv.org/abs/1301.3781" rel="noopener ugc nofollow" target="_blank">话题</a>，但是这个想法是，出现在相似上下文中的单词应该有相似的向量。例如，如果单词pizza经常出现在单词“ate”、“restaurant”和“Italian”附近，则pizza的向量将与这些单词的向量具有高余弦相似性。很少一起出现在文本中的单词将具有低余弦相似性，潜在地一直到-1。</p><h2 id="59bb" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">历史</h2><p id="e3f9" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">像n-grams和将单词表示为向量这样的想法存在了很长时间，但直到2013年<a class="ae jj" href="https://arxiv.org/abs/1301.3781" rel="noopener ugc nofollow" target="_blank">的Word2vec论文</a>和实现发表时，才显示出“以低得多的计算成本实现了准确性的大幅提高”。托马斯·米科洛夫同时致力于Word2Vec和fastText。</p><p id="961a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我现在才知道这件事，但迟做总比不做好:)</p><h2 id="f305" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">为什么在Python中使用类型？</h2><p id="eed9" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">我同意Michael Bolin的观点，“在为一个大型软件项目选择语言时，静态类型是一个必不可少的特性”。类型帮助我使代码可读性更强，错误更少。即使对于这个小项目，在运行代码之前看到Atom中的错误也非常有帮助，节省了我很多时间。</p><p id="4691" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最棒的是Python 3运行时接受类型注释。任何人都可以运行我的代码，无需任何额外的设置。在运行代码之前，不需要转换代码，例如在使用带有JavaScript的Flow时。</p><h2 id="5311" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">最佳化</h2><p id="83cd" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">代码根本没有优化，也没有做太多的错误处理。至少，我们可以将所有向量归一化，以使余弦相似度的计算更快(在我的MacBook Pro上，一次调用<code class="du jd je jf jg b">sorted_by_similarity</code>来回答一个问题对于100k个单词需要大约7s)。我们应该用numpy。Python进程使用了将近1GB的内存。我们可以使用现有的实现，它可以简单地加载文件并回答问题。所有这些都超出了本文的范围。我想看看我是否能从头开始写一些非常简单的代码来回答一些有趣的问题。</p><h2 id="6841" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">加载和清理数据</h2><p id="5608" class="pw-post-body-paragraph if ig hi ih b ii kf ik il im kg io ip iq kh is it iu ki iw ix iy kj ja jb jc hb bi translated">下面是<code class="du jd je jf jg b">load_words</code>函数的作用:</p><figure class="kk kl km kn fd kx"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="e8dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">load_words_raw</code>简单地逐行读取文件，并将每行解析成一个<code class="du jd je jf jg b">Word</code>。我们加载了100k个单词，每个单词有300个维度，Python进程使用了近1GB的内存(！)—这很糟糕，但我们暂时还能忍受。</p><p id="e398" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">remove_stop_words</code>丢弃以非字母数字字符开头或结尾的单词，如“inter-”、“thanks”和“- redrose64”。我们剩下98，648个单词。</p><p id="d72d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du jd je jf jg b">remove_duplicates</code>忽略标点符号，因此“U.K”、“U.K .”和“UK”是同一个单词，只存储一次。我们剩下97190个单词。还有一些重复的，比如“年”“年”。我们可以忽略大小写，但这样我们就会失去“us”和“US”(美国)之间的区别。</p><figure class="kk kl km kn fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mk"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">这篇文章发表在<a class="ae jj" href="https://medium.com/swlh" rel="noopener">《创业</a>》上，这是Medium最大的创业刊物，有289，682+人关注。</h2><h2 id="7945" class="jk jl hi bd jm jn jo jp jq jr js jt ju iq jv jw jx iu jy jz ka iy kb kc kd ke bi translated">在这里订阅接收<a class="ae jj" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="kk kl km kn fd kx er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mk"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>