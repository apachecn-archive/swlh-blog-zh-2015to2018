<html>
<head>
<title>Git hooks for PHP projects with Crook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Crook实现PHP项目的Git挂钩</h1>
<blockquote>原文：<a href="https://medium.com/swlh/git-hooks-for-php-projects-using-crook-e435cbf1df99?source=collection_archive---------3-----------------------#2018-10-23">https://medium.com/swlh/git-hooks-for-php-projects-using-crook-e435cbf1df99?source=collection_archive---------3-----------------------#2018-10-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4e24d5980b3f5b35cc18dd4bfe79771e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0sbIcfbtMOCsbbqmrl6lg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx">Photo by <a class="ae iu" href="https://unsplash.com/photos/rylQj173QZI?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Sara Cardoso</a> on <a class="ae iu" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c101" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个项目从寻找一些工具来帮助我管理一个简单项目的Git挂钩开始。像每个正常的开发人员一样，在尝试编写自己的问题解决方案之前，我去找了优秀的Packagist，并为这项工作寻找了一些工具。有的是！真的，很多工具。</p><p id="a901" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我打开了几个标签，开始阅读关于项目、用法等，但我没有找到任何我想要的东西。所有这些工具不仅仅是管理Git挂钩。其中一些附带了一些检查，另一些则严重依赖于名称空间。一件简单的事情，一个非常复杂的过程。</p><h1 id="cc4a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">我在找什么？</h1><p id="e485" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我想要最简单的事情:事件发生，然后触发一些由我或其他人编写的代码。不管是什么语言，如果我想在Ruby脚本中插入一个<strong class="ix kw">预提交</strong>钩子，那就没问题。如果我想运行一个Bash脚本，一个Golang的二进制文件，随便什么。对我来说，工具必须接受事件并触发挂钩的动作。就是这样。我没找到。当我们找不到合适的工具时，我们该怎么办？我们创造了一个，并将其开源。: )</p><h1 id="41e2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第一，要求</h1><p id="d4b1" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我需要一些东西来管理客户端Git挂钩。当一些客户端钩子事件被触发时，这个工具应该允许我运行任何我想运行的东西，不管是什么语言。它必须简单、直接、易于安装、易于使用，必须是Packagist上可用的包，具有很少的依赖性，并且用PHP编写。</p><h1 id="340d" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">克鲁克来了</h1><p id="f6d0" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Crook是(至少对我来说)管理PHP项目中Git挂钩的最简单的方法。是我试图为这项工作创造一个好的工具。在接下来的部分中，我将更详细地解释一切是如何工作的，以及如何使用它来集成项目中的动作和钩子。我在Packagist <a class="ae iu" href="https://packagist.org/packages/felipebool/crook" rel="noopener ugc nofollow" target="_blank">这里</a>发表了它，你可以在我的GitHub页面<a class="ae iu" href="https://github.com/felipebool/crook" rel="noopener ugc nofollow" target="_blank">这里</a>找到源代码。</p><p id="5ef3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你只是需要一些基础知识，让我简单解释一下。<strong class="ix kw">TL；DR </strong>:安装后，在composer的脚本部分创建一个条目，并给它一个名称，任何名称，然后运行Crook add命令(一次)将该脚本(动作)绑定到给定的钩子名称(事件)。当事件被触发时，该脚本将运行。就是这样。</p><h1 id="e903" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">它是如何工作的？</h1><p id="cb4f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">首先，你跑</p><p id="c728" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du kx ky kz la b">$ vendor/bin/crook init</code></p><p id="9904" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这个命令将创建一个名为crook.json的JSON文件，这个文件负责保存Git钩子名称和动作之间的绑定，以及其他一些配置信息。没有必要手动更改它，你可以通过命令行使用Crook做任何事情。</p><p id="2840" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在脚本部分的composer.json上添加一个条目后，您可以像这样将该操作绑定到钩子</p><p id="8462" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du kx ky kz la b">$ vendor/bin/crook add hook-name action-name</code></p><p id="56a8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">移除钩子也是一样</p><p id="f8d1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du kx ky kz la b">$ vendor/bin/crook remove hook-name</code></p><p id="37c9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，假设你在你的团队中讨论代码风格时遇到了困难，所有的代码评审都是基于“在这里放一个空行”，“将这个括号发送到下一行”和所有这类不重要的东西。选择您的代码检查/代码美化工具，并将其插入预提交g it挂钩。在composer.json中添加一些条目，然后运行</p><p id="f8b4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du kx ky kz la b">$ vendor/bin/crook add pre-commit code-check</code></p><p id="259f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下次有人试图创建一个新的提交时，代码检查将会运行，并根据您公司的代码标准运行一些修复。顺便说一下，我在另一篇文章中讨论了一些关于phpc和其他有趣的PHP工具和概念，如果你不知道或者想好好读一读，请看看<a class="ae iu" href="https://medium.freecodecamp.org/this-is-what-modern-php-looks-like-769192a1320" rel="noopener ugc nofollow" target="_blank">这就是现代PHP的样子</a>。</p><h1 id="88a6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">该机制</h1><p id="dd3f" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Git挂钩基于你在里面创建的动作/文件。git/hooks。所以，如果你进入你的项目并列出这个目录，你会发现一些样本文件来帮助你创建你自己的钩子。</p><p id="d7cd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">克鲁克所做的只是创建一个符号链接。git/hooks/some-hook到一个名为theHook的文件，所以，每次你添加一个新的钩子，在钩子文件和theHook之间就会创建一个新的符号链接。这样，当它触发该脚本时，该书将运行，然后执行您添加的任何操作。这就是我在本文开头所说的原因，你可以运行任何你想运行的东西，服务器中所有可用的命令都可以使用，你可以用任何语言创建脚本，混合东西，在那里施展你的魔法。</p><h1 id="0c06" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">该项目</h1><p id="a8b5" class="pw-post-body-paragraph iv iw hi ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">我有一个很好的时间来创建这个，我希望它能对你的项目有所帮助。你可以在它的Github页面上找到更多关于Crook的信息。我上一次提交是在几个月前，但它似乎真的很稳定，并进行了一些测试。我知道一家公司用它为一个PHP团队管理钩子，我得到了一些好的反馈。如果有人可以使用它，发现问题，报告问题，或者做出贡献，我将不胜荣幸。欢迎任何批评或问题。</p><p id="40c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你用什么来管理Git挂钩？你对这种类型的工具有什么期望？在评论里告诉我。</p><figure class="lc ld le lf fd ij er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es lb"><img src="../Images/308a8d84fb9b2fab43d66c117fcc4bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YqDjlKFwScoQYQ62DWEdig.png"/></div></a></figure><h2 id="c148" class="lg ju hi bd jv lh li lj jz lk ll lm kd jg ln lo kh jk lp lq kl jo lr ls kp lt bi translated">这篇文章发表在<a class="ae iu" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，有+ 382，862人关注。</h2><h2 id="869c" class="lg ju hi bd jv lh li lj jz lk ll lm kd jg ln lo kh jk lp lq kl jo lr ls kp lt bi translated">在这里订阅接收<a class="ae iu" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="lc ld le lf fd ij er es paragraph-image"><a href="https://medium.com/swlh"><div class="er es lb"><img src="../Images/b0164736ea17a63403e660de5dedf91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouK9XR4xuNWtCes-TIUNAw.png"/></div></a></figure></div></div>    
</body>
</html>