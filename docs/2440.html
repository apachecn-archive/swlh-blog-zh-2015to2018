<html>
<head>
<title>Best practices for designing a Rails app that connects to a 3rd party API?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计连接到第三方API的Rails应用程序的最佳实践？</h1>
<blockquote>原文：<a href="https://medium.com/swlh/best-practices-for-designing-a-rails-app-that-connects-to-a-3rd-party-api-744a24162b35#2018-01-29">https://medium.com/swlh/best-practices-for-designing-a-rails-app-that-connects-to-a-3rd-party-api-744a24162b35#2018-01-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e3a5999e1666784b97b7712c3a661900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*89cm7qOgO1Rn1zs8gXw1-Q.jpeg"/></div></div></figure><p id="1a4e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated"><span class="l jp jq jr bm js jt ju jv jw di">您是否需要一项服务来补充您目前的应用？或者你有一个应用程序的想法，但不想收集你需要的数据的麻烦？不管你的理由是什么，在许多web应用程序的开发周期中，第三方集成是不可避免的。最简单的方法之一是公开一个REST API以供使用。下面我们分享了一些设计REST API的要点，并将涵盖一系列确保代码可维护性的良好实践。</span></p><h1 id="fda7" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">什么是RESTful API？</h1><p id="cbbc" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hb bi translated">一种被称为表述性状态转移或REST的架构方法建议web应用程序必须像最初设想的那样处理HTTP。对于一个理论上纯粹的REST API来说，需要满足的标准不止三个，但是下面的标准在实践中已经足够了。</p><ul class=""><li id="760e" class="la lb hi is b it iu ix iy jb lc jf ld jj le jn lf lg lh li bi translated">每一个单独的请求都不能与之前的请求有任何关联。也就是说，客户端状态不应该在请求之间存储在服务器上。</li><li id="e6c2" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">表示为数据(通常是JSON或XML)的资源必须由资源端点返回。返回的信息应该足以让客户端识别并唯一地操作有问题的数据库行。</li><li id="1313" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">每个请求必须唯一地标识一个特定的资源。换句话说，修改数据库的每个请求应该只作用于单个表的单个行。只获取信息的请求应该从一个表中获取零行或多行。</li></ul><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/6b63f86bfcd98e9287f9d441806b4811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4bup_BR548RTtT9lUPshw.png"/></div></div></figure><h1 id="2c0d" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在Rails中设计一个基本的RESTful API时，需要记住以下几点:</h1><ul class=""><li id="7c4e" class="la lb hi is b it kv ix kw jb ls jf lt jj lu jn lf lg lh li bi translated">说到命名，虽然Rails允许您或多或少地互换使用PUT和POST，但是您的API会被其他开发人员使用。记住这一点，一个好的做法是采用最小惊奇的原则，为更新放置，为创建发布，为更新打补丁并插入。此外，您的应用程序将由不同的开发人员维护，可能在您离开后很久。使用符合标准实践的方法会使练习变得更容易。</li><li id="78c2" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">一旦你公开了你的API，假设有人在使用它。因此，除了关键的错误修复，您决不能修改现有的API。公开一个新版本，而不是改变现有的端点。一种方法可能是构建版本化的路径和控制器。此外，只有在API经过密集的内部测试之后，才公开它。</li><li id="5c19" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">谈到路由参数，虽然可以根据目标资源的id列来识别路由，但它假定消费应用程序有更高程度的知识。利用可能不是唯一的，但像name这样的公共标识符可以减少需要公开的系统内部信息的数量，同时让客户端可以轻松地查找发出请求所需的数据。缺点是嵌套路由更长。</li><li id="064c" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">在处理提取通用API功能和认证时，一个基本的API控制器就派上了用场。通常的方法是要求对每个请求进行重新认证。这可能是确保无国籍的最简单的方法。</li><li id="f0d7" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">防御性编程是一种软件设计原则，它规定一个软件必须被设计成即使在不可预见的情况下也能继续运行。在API设计中应用这种实践很重要，因为您的API将向第三方开发人员公开，允许他们提交任意输入。在构建API时，本着防御性编程的精神，问问自己，用户能提交的最随机、最不期望或最恶意的输入是什么。然后编写代码来处理这个问题。</li><li id="9423" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">HTTP状态代码，像HTTP动词一样，有明确的含义，尽管返回404或未找到、200或正常、500或内部服务器错误是如此容易。为了其他开发人员，使用有意义的状态代码。</li><li id="4353" class="la lb hi is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li bi translated">一个灵活、枯燥、RESTful的API允许我们在维护相同数据库模型的同时拥有API特有的行为。但是为了测试这一点，请求级规范是最合适的，因为每个请求都是一个无状态的事务，而且大部分提升都是在控制器级完成的。实现这一点的最简单的方法是控制器测试，它与控制器端点测试的通常模型没有太大的不同。基本上，我们创建JSON请求并将它们发送到端点。</li></ul></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="ca6b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="md">原载于</em> <a class="ae lv" href="https://www.cognitiveclouds.com/insights" rel="noopener ugc nofollow" target="_blank"> <em class="md">产品洞察博客</em> </a> <em class="md">来自cognitive clouds:Top</em><a class="ae lv" href="https://www.cognitiveclouds.com/custom-software-development-services/ruby-on-rails-development-company" rel="noopener ugc nofollow" target="_blank"><em class="md">Ruby on Rails开发公司</em> </a></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="mf jy hi bd jz mg mh mi kd mj mk ml kh jb mm mn kl jf mo mp kp jj mq mr kt ms bi translated">这个故事发表在<a class="ae lv" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有292，582+人关注。</h2><h2 id="7945" class="mf jy hi bd jz mg mh mi kd mj mk ml kh jb mm mn kl jf mo mp kp jj mq mr kt ms bi translated">在这里订阅接收<a class="ae lv" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>