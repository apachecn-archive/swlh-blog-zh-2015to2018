<html>
<head>
<title>Only Numpy: Deriving Forward feed and Back Propagation in Gated Recurrent Neural Networks (GRU) — Empirical Evaluation of Gated Recurrent Neural Networks on Sequence Modeling — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Only Numpy:推导门控递归神经网络中的前馈和反向传播(GRU) —门控递归神经网络对序列建模的经验评估—第1部分</h1>
<blockquote>原文：<a href="https://medium.com/swlh/only-numpy-deriving-forward-feed-and-back-propagation-in-gated-recurrent-neural-networks-gru-8b6810f91bad#2018-01-15">https://medium.com/swlh/only-numpy-deriving-forward-feed-and-back-propagation-in-gated-recurrent-neural-networks-gru-8b6810f91bad#2018-01-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="8d5d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天，我将在门控递归神经网络上推导前馈过程和反向传播，建议阅读论文“门控递归神经网络对序列建模的实证评估”——此处链接论文<a class="ae jd" href="https://arxiv.org/abs/1412.3555" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="e41c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">网络架构</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/9d6f6835400a13cb0a9a8185aadf580b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0XhoRj9m1KGYpEVkLYw_BQ.jpeg"/></div></div><figcaption class="jy jz et er es ka kb bd b be z dx">Network Arch</figcaption></figure><p id="bf9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在左边的屏幕是你需要的所有等式，蓝色方框的符号叫做“候选激活”。(将它们简称为<strong class="ih jl">CA</strong>)现在也忽略红色方框，但是这在执行反向传播时变得非常重要。</p><p id="0bce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">R(t) →在时间戳t重置门<br/> CA(t) →在时间戳t候选激活功能<br/> Z(t) →在时间戳t更新门<br/> S(t) →在时间戳t状态</p><p id="5725" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像往常一样，我将使用L2成本函数，这是屏幕左侧显示的最底部的方程。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/4d1e50d5d1a44bc2995d73167a05908b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IcQdRiej3QtG4s0kIrUvHA.jpeg"/></div></div></figure><p id="bd07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有一点很重要，要注意的是整个方程的权重。如上所示，总共有6个砝码。这意味着，当执行反向传播时，我们需要计算上述6个权重的错误率！</p><p id="cc57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以总的来说，我们可以预期总共有6个方程。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/29d3e72e51f9ddb96bd1764e0f2b1f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgGq_4XWXVSowwPqNfqDbg.jpeg"/></div></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es kc"><img src="../Images/674ea779444fabbac33814ab8bc672f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DjDUuIdQEV0M0MsoTO99ng.png"/></div></div></figure><p id="c2b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图是GRU的两个图像</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="ee07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">正向进给过程</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/b482baac888d1374d09f79a727556a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*coLT0caktPJdWKQXqZtSTg.jpeg"/></div></div></figure><p id="7701" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，前馈操作非常简单，易于计算，在每个时间戳，我们可以使用L2成本函数计算错误率。如屏幕顶部所示，TS代表时间戳。</p></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="96eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">时间戳2处的反向传播</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/a1c3a3e76dd69e1229f1364c659a886b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lSAdiucAerQvlERDA8Tviw.jpeg"/></div></div></figure><p id="b6f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像往常一样，对于每个RNN，计算每个权重的最近反向传播，如我所说，有6个，相对容易。</p><p id="b4e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1 →时间戳的错误率2相对于重量Wz <br/> 2 →时间戳的错误率2相对于重量Wrecz <br/> 3 →时间戳的错误率2相对于重量Wca <br/> 4 →时间戳的错误率2相对于重量wreca<br/>5→时间戳的错误率2相对于重量Wr<br/>T18】6→时间戳的错误率2相对于重量Wrecr </p><p id="5bfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:我没有做6等式，你自己试试吧。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/2f85a44a65029589ea9103aabb25db35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WqzvJjo-hslM8IjhZbiLZA.jpeg"/></div></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/32d8a522f0215773ffa0d659a1d4bd60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tBYqhH4obkomJ5NBfcXP2Q.jpeg"/></div></div></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><p id="81d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih jl">相对于Wz的时间戳1处的反向传播</strong></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/785c649b2e34a734e806598bf40eec7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XsLbX21Oy_T7GQ9VmwpERA.jpeg"/></div></div></figure><p id="e028" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，正如我们已经预料到的，任何RNN的反向传播过程在早期都会变得混乱和复杂。同样，为了得到时间戳为1时的总错误率，我们需要得到时间戳为1和时间戳为2时的错误率。</p><p id="3bf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，请注意红色下划线符号，所有反向传播共享该变量。这意味着如果我们首先计算共享变量，我们将能够节省计算时间。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/9be5c7ffa6f1e7ee4806f0329c197444.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPlVz0j0EHqWPl40kl-Rog.jpeg"/></div></div></figure><p id="4497" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">红框→时间戳为1时的错误率<br/>绿框→时间戳为2时的错误率</p><p id="e929" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">两个变量的总和就是我们需要更新权重的总梯度。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/e67052d24787cad5332449853122736f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5SO080sdU9WxkZYs4QlAIg.jpeg"/></div></div></figure><p id="bb13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数学符号如上图，实际方程如下图。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/9a1c4a273c0f5d8eb10739ccaec2ffae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gnd0mzrDtJKEkWhSf4WUg.jpeg"/></div></div></figure></div><div class="ab cl je jf gp jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="hb hc hd he hf"><h2 id="b880" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">最后的话</h2><p id="a43f" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">这是第一部分，我会很快给你们第二部分和第三部分的更新…(我希望如此)。如果发现任何错误，请发电子邮件到jae.duk.seo@gmail.com找我。</p><p id="ccc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同时，在我的推特<a class="ae jd" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>关注我，并访问<a class="ae jd" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或我的<a class="ae jd" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解更多内容。如果你感兴趣的话，我还在简单的RNN <a class="ae jd" rel="noopener" href="/@SeoJaeDuk/only-numpy-vanilla-recurrent-neural-network-with-activation-deriving-back-propagation-through-time-4110964a9316">上做了反向传播。</a></p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es le"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure><h2 id="fd41" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">这个故事发表在<a class="ae jd" href="https://medium.com/swlh" rel="noopener"> The Startup </a>上，这是Medium最大的创业刊物，拥有295，232+人关注。</h2><h2 id="7945" class="ke kf hi bd kg kh ki kj kk kl km kn ko iq kp kq kr iu ks kt ku iy kv kw kx ky bi translated">在此订阅接收<a class="ae jd" href="http://growthsupply.com/the-startup-newsletter/" rel="noopener ugc nofollow" target="_blank">我们的头条新闻</a>。</h2><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es le"><img src="../Images/731acf26f5d44fdc58d99a6388fe935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gfnVvkMRFtjVsWF7vkClA.png"/></div></div></figure></div></div>    
</body>
</html>